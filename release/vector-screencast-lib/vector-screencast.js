var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(t,e){this.x=t,this.y=e}return Object.defineProperty(t.prototype,"X",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Y",{get:function(){return this.y},enumerable:!0,configurable:!0}),t.prototype.isEqualTo=function(t){return this.X===t.X&&this.Y===t.Y},t.prototype.getSize=function(){return Math.sqrt(this.getSizeSq())},t.prototype.getSizeSq=function(){return this.x*this.x+this.y*this.y},t.prototype.distanceTo=function(t){var e=this.x-t.X,n=this.y-t.Y;return Math.sqrt(e*e+n*n)},t.prototype.normalize=function(){var t=this.getSize();if(0===t)throw new Error("Can't normalize zero vector.");return this.scale(1/t),this},t.prototype.getNormal=function(){return new t(-this.y,this.x).normalize()},t.prototype.add=function(t){return this.x+=t.X,this.y+=t.Y,this},t.prototype.subtract=function(t){return this.x-=t.X,this.y-=t.Y,this},t.prototype.scale=function(t){return this.x*=t,this.y*=t,this},t.prototype.pointInBetween=function(e){return new t((this.x+e.X)/2,(this.y+e.Y)/2)},t.prototype.clone=function(){return new t(this.x,this.y)},t}();t.Vector2=e}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){!function(t){t[t.Warning=0]="Warning",t[t.Fatal=1]="Fatal"}(t.ErrorType||(t.ErrorType={}));var e=t.ErrorType,n=function(){function t(){}return t.TurnOn=function(){this.doLog=!0},t.TurnOff=function(){this.doLog=!1},t.SetLogFunction=function(t){this.LogFunction=t},t.Report=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.doLog&&this.LogFunction(t,e)},t.ErrorTypeName=function(t){switch(t){case e.Warning:return"Warning";case e.Fatal:return"Fatal error";default:return"Unknown error type"}},t.doLog=!0,t.LogFunction=function(n,r){if(n===e.Fatal)throw new Error("Fatal Error: "+r.join(";Â "));console.log(t.ErrorTypeName(n),r)},t}();t.Errors=n}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(){}return t.CreateElement=function(e,n,r){var i=document.createElement(e);if(n&&t.SetAttributes(i,n),r&&Array.isArray(r))for(var o in r)i.appendChild(r[o]);return i},t.SetAttributes=function(t,e){for(var n in e)t.setAttribute(n,e[n])},t}();t.HTML=e}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function e(){}return e.Check=function(t,e){return 200===t.status&&e?t.getResponseHeader("ContentType")===e:!0},e.Exists=function(t,e){var n=new XMLHttpRequest;return n.open("HEAD",t,!1),n.send(),this.Check(n,e)},e.ExistsAsync=function(t,e,n,r){var i=this,o=new XMLHttpRequest;o.open("HEAD",t,!0),o.onerror=n,o.ontimeout=n,o.onload=function(t){i.Check(o,r)?e(t):n(t)},o.send()},e.ReadFileAsync=function(t,e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.onerror=function(t){return n(r.status)},r.ontimeout=function(t){return n(r.status)},r.onload=function(t){200===r.status?e(r.responseXML?r.responseXML:r.response):n(r.status)},r.send()},e.ReadXmlAsync=function(t,e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.onerror=function(t){return n(r.status)},r.ontimeout=function(t){return n(r.status)},r.onload=function(t){200===r.status?e(r.responseXML):n(r.status)},r.send()},e.Download=function(e,n){var r=t.HTML.CreateElement("a",{css:"display: none"});document.documentElement.appendChild(r);var i=URL.createObjectURL(e);t.HTML.SetAttributes(r,{href:i,download:n}),r.click(),URL.revokeObjectURL(i)},e.CurrentDateTime=function(){new Date;return"$(date.getMonth())-$(date.getDay())-$(date.getFullYear())_$(date.getHour())-$(date.getMinute())"},e.StartDownloadingWav=function(t){e.Download(t,"recording-"+e.CurrentDateTime()+".wav")},e.StartDownloadingXml=function(t){var n=new Blob([t],{type:"text/xml"});e.Download(n,"data-"+e.CurrentDateTime()+".xml")},e}();t.File=e}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){function e(t,e){return void 0===e&&(e=o),Number(t.toFixed(e))}function n(t,n){return void 0===n&&(n=o),e(t,n).toString()}function r(t){var e,n=Math.floor(t/60);e=n+":";var r=Math.floor(t%60);return e+=9>=r?"0"+r.toString(10):r.toString(10)}function i(t){return r(Math.floor(t/1e3))}var o=3;t.maxDecPlaces=e,t.precise=n,t.secondsToString=r,t.millisecondsToString=i}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function e(){}return e.catmullRomToBezier=function(e,r,i,o){return new n(r,new t.Vector2(-1/6*e.X+r.X+1/6*i.X,-1/6*e.Y+r.Y+1/6*i.Y),i,new t.Vector2(1/6*r.X+i.X+-1/6*o.X,1/6*r.Y+i.Y+-1/6*o.Y))},e}();t.Spline=e;var n=function(){function t(t,e,n,r){this.start=t,this.startCP=e,this.end=n,this.endCP=r}return Object.defineProperty(t.prototype,"Start",{get:function(){return this.start},set:function(t){this.start=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"StartCP",{get:function(){return this.startCP},set:function(t){this.startCP=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"End",{get:function(){return this.end},set:function(t){this.end=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndCP",{get:function(){return this.endCP},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EndCp",{set:function(t){this.endCP=t},enumerable:!0,configurable:!0}),t}();t.BezierCurveSegment=n}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=t.precise,n=function(){function t(){}return Object.defineProperty(t,"Namespace",{get:function(){return this.namespace},enumerable:!0,configurable:!0}),t.CreateDot=function(t,n,r){return this.CreateElement("circle",{cx:e(t.X),cy:e(t.Y),r:e(n),fill:r,stroke:"transparent"})},t.CreateCircle=function(t,n,r){return n>0?this.CreateElement("circle",{cx:e(t.X),cy:e(t.Y),r:e(n),stroke:r,fill:"transparent","stroke-width":1}):null},t.CreateLine=function(t,n,r,i){return r>0?this.CreateElement("path",{fill:"transparent",stroke:i,"stroke-width":e(r),d:this.MoveToString(t)+" "+this.LineToString(n)}):null},t.CreateElement=function(t,e){var n=document.createElementNS(this.namespace,t);return e&&this.SetAttributes(n,e),n},t.SetAttributes=function(t,e){t||console.log(e);for(var n in e)t.setAttributeNS(null,n,e[n])},t.MoveToString=function(t){return"M "+e(t.X)+","+e(t.Y)},t.LineToString=function(t){return"L "+e(t.X)+","+e(t.Y)},t.CurveToString=function(t,n,r){return"C "+e(t.X)+","+e(t.Y)+" "+e(n.X)+","+e(n.Y)+" "+e(r.X)+","+e(r.Y)},t.ArcString=function(t,n,r){return"A "+e(n)+","+e(n)+" "+r+" 0,0 "+e(t.X)+","+e(t.Y)},t.attr=function(t,e){var n=t.attributes.getNamedItemNS(null,e);if(n)return n.textContent;throw new Error("Attribute "+e+" is missing in "+t.localName)},t.numAttr=function(t,e){return Number(t.attributes.getNamedItemNS(null,e).textContent)},t.namespace="http://www.w3.org/2000/svg",t}();t.SVG=n;var r=function(){function t(){}return Object.defineProperty(t,"Namespace",{get:function(){return this.namespace},enumerable:!0,configurable:!0}),t.CreateElement=function(t,e){var n=document.createElementNS(this.namespace,"a:"+t);return e&&this.SetAttributes(n,e),n},t.SetAttributes=function(t,e){t||console.log(e);for(var n in e){var r=document.createAttributeNS(this.namespace,"a:"+n);r.textContent=e[n],t.attributes.setNamedItemNS(r)}},t.attr=function(t,e,n){var r=t.attributes.getNamedItemNS(this.Namespace,e);if(r)return r.textContent;if(n)return n;throw new Error("Attribute "+e+" is missing in "+t.localName)},t.numAttr=function(e,n,r){return Number(t.attr(e,n,void 0!==r?r.toString():void 0))},t.namespace="http://www.rozsival.com/2015/vector-screencast",t}();t.SVGA=r}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},VectorScreencast;!function(t){var e;!function(t){!function(t){t[t.ChangeBrushSize=0]="ChangeBrushSize",t[t.ChangeColor=1]="ChangeColor",t[t.Cursor=2]="Cursor"}(t.StateType||(t.StateType={}));var e=t.StateType,n=function(){function t(t,e){this.type=t,this.time=e}return t.prototype.GetType=function(){return this.type},t.prototype.GetTime=function(){return this.time},t}();t.State=n;var r=function(n){function r(t,r,i,o){n.call(this,e.Cursor,t),this.x=r,this.y=i,this.pressure=o}return __extends(r,n),Object.defineProperty(r.prototype,"X",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Y",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Pressure",{get:function(){return this.pressure},enumerable:!0,configurable:!0}),r.prototype.getPosition=function(){return new t.Vector2(this.x,this.y)},r}(n);t.CursorState=r;var i=function(t){function n(n,r){t.call(this,e.ChangeColor,n),this.color=r}return __extends(n,t),Object.defineProperty(n.prototype,"Color",{get:function(){return this.color},enumerable:!0,configurable:!0}),n}(n);t.ColorState=i;var o=function(t){function n(n,r){t.call(this,e.ChangeBrushSize,n),this.size=r}return __extends(n,t),Object.defineProperty(n.prototype,"Size",{get:function(){return this.size},enumerable:!0,configurable:!0}),n}(n);t.SizeState=o}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){!function(t){t[t.Start=0]="Start",t[t.Pause=1]="Pause",t[t.ReachEnd=2]="ReachEnd",t[t.JumpTo=3]="JumpTo",t[t.VideoInfoLoaded=4]="VideoInfoLoaded",t[t.BufferStatus=5]="BufferStatus",t[t.CursorState=6]="CursorState",t[t.ChangeColor=7]="ChangeColor",t[t.ChangeBrushSize=8]="ChangeBrushSize",t[t.StartPath=9]="StartPath",t[t.DrawSegment=10]="DrawSegment",t[t.DrawPath=11]="DrawPath",t[t.ClearCanvas=12]="ClearCanvas",t[t.RedrawCanvas=13]="RedrawCanvas",t[t.CanvasSize=14]="CanvasSize",t[t.CanvasScalingFactor=15]="CanvasScalingFactor",t[t.CursorOffset=16]="CursorOffset",t[t.RegisterRecordingTool=17]="RegisterRecordingTool",t[t.RecordingToolFinished=18]="RecordingToolFinished",t[t.MuteAudioRecording=19]="MuteAudioRecording",t[t.AudioRecordingAvailable=20]="AudioRecordingAvailable",t[t.AudioRecordingUnavailable=21]="AudioRecordingUnavailable",t[t.StartUpload=22]="StartUpload",t[t.DownloadData=23]="DownloadData",t[t.VolumeUp=24]="VolumeUp",t[t.VolumeDown=25]="VolumeDown",t[t.Mute=26]="Mute",t[t.Busy=27]="Busy",t[t.Ready=28]="Ready",t[t.length=29]="length"}(t.VideoEventType||(t.VideoEventType={}));var e=t.VideoEventType,n=function(){function t(t){this.type=t,this.listeners=new Array(0)}return Object.defineProperty(t.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),t.prototype.on=function(t){this.listeners.push(t)},t.prototype.off=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},t.prototype.trigger=function(t){for(var e=0;e<this.listeners.length;e++){var n=this.listeners[e];n.apply(this,t)}},t}(),r=function(){function t(){this.events=new Array(e.length)}return t.prototype.on=function(t,e){this.events[t]||(this.events[t]=new n(t)),this.events[t].on(e)},t.prototype.off=function(t,e){this.events[t]&&this.events[t].off(e)},t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.events[t];r&&r.trigger(e)},t}();t.VideoEvents=r}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(t){this.pauseTime=0,window.performance?this.clock=window.performance:this.clock=Date,this.paused=!t,this.Reset()}return Object.defineProperty(t.prototype,"StartTime",{get:function(){return this.startTime},enumerable:!0,configurable:!0}),t.prototype.CurrentTime=function(){return this.paused?this.pauseTime:this.clock.now()-this.startTime},t.prototype.SetTime=function(t){this.paused?this.pauseTime=t:this.startTime=this.clock.now()-t},t.prototype.Pause=function(){this.pauseTime=this.CurrentTime(),this.paused=!0},t.prototype.Resume=function(){this.paused=!1,this.Reset(),this.SetTime(this.pauseTime)},t.prototype.Reset=function(){this.startTime=this.clock.now()},t}();t.VideoTimer=e}(e=t.Helpers||(t.Helpers={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.VideoEventType,r=t.Helpers.Errors,i=t.Helpers.ErrorType;!function(t){t[t.MP3=0]="MP3",t[t.OGG=1]="OGG",t[t.WAV=2]="WAV"}(e.AudioSourceType||(e.AudioSourceType={}));var o=e.AudioSourceType,s=function(){function t(t,e){this.url=t,this.type=e}return Object.defineProperty(t.prototype,"Url",{get:function(){return this.url},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Type",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MimeType",{get:function(){switch(this.type){case o.MP3:return"audio/mp3";case o.OGG:return"audio/ogg";case o.WAV:return"audio/wav";default:return null}},enumerable:!0,configurable:!0}),t.StringToType=function(t){switch(t){case"audio/mp3":return o.MP3;case"audio/wav":return o.WAV;case"audio/ogg":return o.OGG;default:throw new Error("Unknown audio type "+t)}},t}();e.AudioSource=s;var a=function(){function e(t,e){this.events=t,this.audio=this.CreateAudio(e),null===this.audio?this.isReady=!1:(this.playing=!1,this.reachedEnd=!1,this.InitAudio(),this.isReady=!0,document.documentElement.appendChild(this.audio),console.log("Audio is available."))}return Object.defineProperty(e.prototype,"IsReady",{get:function(){return this.isReady},enumerable:!0,configurable:!0}),e.prototype.CreateAudio=function(e){try{var n=new Audio;if(!n.canPlayType)return r.Report(i.Warning,"AudioPlayer: browser does not support HTML5 audio"),null;for(var o=!1,s=0;s<e.length;s++){var a=e[s];if("probably"===n.canPlayType(a.MimeType)){var u=t.Helpers.HTML.CreateElement("source",{src:a.Url,type:a.MimeType});n.appendChild(u),o=!0}}if(o===!1)for(var s=0;s<e.length;s++){var a=e[s];if("maybe"===n.canPlayType(a.MimeType)){var u=t.Helpers.HTML.CreateElement("source",{src:a.Url,type:a.MimeType});n.appendChild(u),o=!0}}return o===!1?(r.Report(i.Warning,"Browser can't play any of available audio sources.",e),null):n}catch(c){return r.Report(i.Warning,"AudioPlayer: can't create audio element",c),null}},e.prototype.InitAudio=function(){var t=this;this.audio.onended=function(){return t.events.trigger(n.ReachEnd)},this.audio.onwaiting=function(){return t.Busy()},this.audio.oncanplay=function(){return t.Ready()},this.events.on(n.Mute,function(){return t.Mute()}),this.events.on(n.VolumeUp,function(){return t.VolumeUp()}),this.events.on(n.VolumeDown,function(){return t.VolumeDown()}),this.MonitorBufferingAsync()},e.prototype.Busy=function(){this.playing&&(this.triggeredBusyState=!0,this.events.trigger(n.Pause))},e.prototype.Ready=function(){this.triggeredBusyState&&(this.events.trigger(n.Ready),this.triggeredBusyState=!1)},e.prototype.Play=function(){this.isReady&&(1==this.reachedEnd&&this.Rewind(),this.audio.play())},e.prototype.InitiatePlay=function(){this.events.trigger(n.Start)},e.prototype.Pause=function(){this.isReady&&this.audio.pause()},e.prototype.ReachedEnd=function(){this.reachedEnd=!0,this.Pause()},e.prototype.Replay=function(){this.Rewind(),this.Play()},e.prototype.Rewind=function(){this.isReady&&(this.audio.pause(),this.audio.currentTime=0,this.reachedEnd=!1)},e.prototype.MonitorBufferingAsync=function(){var t=this,e=0;this.checkPreloaded=setInterval(function(){var r=t.audio.buffered.end(t.audio.buffered.length-1);r!==e&&(t.events.trigger(n.BufferStatus,r),e=r),r===t.audio.duration&&clearInterval(t.checkPreloaded)},300)},e.prototype.JumpTo=function(t){if(this.isReady){this.reachedEnd=!1;var e=this.audio.duration*t;this.ChangePosition(e),clearInterval(this.checkPreloaded),this.MonitorBufferingAsync()}},e.prototype.ChangePosition=function(t){this.audio.currentTime=t},e.prototype.Mute=function(){this.audio.muted=!this.audio.muted},e.prototype.VolumeUp=function(){this.audio.volume=Math.min(1,this.audio.volume+.1)},e.prototype.VolumeDown=function(){this.audio.volume=Math.max(0,this.audio.volume-.1)},e}();e.AudioPlayer=a}(e=t.AudioData||(t.AudioData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.Errors,r=t.Helpers.ErrorType,i=t.Helpers.VideoEventType,o=function(){function t(t,e){var n=this;this.events=e,this.recording=!1,this.initSuccessful=!1,this.doNotStartRecording=!1,this.settings={host:"http://localhost",port:4e3,path:"/upload/audio",recordingWorkerPath:"/js/workers/RecordingWorker.js"},t.host&&(this.settings.host=t.host),t.port&&(this.settings.port=t.port),t.path&&(this.settings.path=t.path),this.recording=!1,this.muted=!1,this.events.on(i.MuteAudioRecording,function(){return n.muted=!n.muted}),this.error=function(t){return console.log("AudioRecorder error: ",t)},this.success=function(t){return console.log("AudioRecorder success: ",t)}}return t.prototype.Init=function(t){var e=this;if(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia&&window.hasOwnProperty("AudioContext")){var o=new AudioContext||null;this.events.trigger(i.Busy),navigator.getUserMedia({video:!1,audio:!0},function(n){if(e.doNotStartRecording===!1){e.input=o.createMediaStreamSource(n);var r=2048;e.scriptProcessorNode=o.createScriptProcessor(r,1,1),e.scriptProcessorNode.onaudioprocess=function(t){return e.processData(t)},e.input.connect(e.scriptProcessorNode),e.scriptProcessorNode.connect(o.destination),e.initSuccessful=!0,e.CreateAudioProcessor("web-socket",e.settings,function(){return console.log("Audio recording is ready.")}),t&&t(),e.events.trigger(i.AudioRecordingAvailable),e.events.trigger(i.RegisterRecordingTool,"audio-recorder"),e.events.trigger(i.Ready)}},function(t){"PermissionDeniedError"===t.name&&n.Report(r.Warning,"User didn't allow microphone recording."),n.Report(r.Warning,"Can't record audio",t),e.events.trigger(i.AudioRecordingUnavailable),e.events.trigger(i.Ready)})}else console.log("getUserMedia not supported by the browser"),n.Report(r.Warning,"getUserMedia not supported by the browser"),this.events.trigger(i.AudioRecordingUnavailable)},t.prototype.CreateAudioProcessor=function(t,e,i,o){var s=this;Worker?(this.recordingWorker=new Worker(e.recordingWorkerPath),this.recordingWorker.onmessage=function(t){return s.ReceiveMessageFromWorker(t)},this.recordingWorker.postMessage({cmd:"init",AudioProcessorType:t||"web-sockets",port:e.port,host:e.host,path:e.path}),i&&i()):(n.Report(r.Fatal,"No web workers support - this feature is not supported by the browser."),o&&o())},t.prototype.Start=function(){return this.initSuccessful===!0?this.recordingWorker?(this.recording=!0,!0):(n.Report(r.Fatal,"No audio processor was set."),!1):(this.doNotStartRecording=!0,!1)},t.prototype.Continue=function(){return this.initSuccessful?this.recordingWorker?(this.recording=!0,!0):(n.Report(r.Fatal,"No audio processor was set."),!1):!1},t.prototype.Pause=function(){return this.initSuccessful?(this.recording=!1,!0):!1},t.prototype.Stop=function(t,e){this.success=t,this.error=e,this.initSuccessful===!0?this.Pause()&&this.recordingWorker&&this.recordingWorker.postMessage({cmd:"finish"}):(n.Report(r.Warning,"Can't stop AudioRecorder - it wasn't ever initialised."),e())},t.prototype.isRecording=function(){return this.initSuccessful},t.prototype.processData=function(t){if(this.recording!==!1){var e=t.inputBuffer.getChannelData(0);if(this.muted)for(var n=0;n<e.length;n++)e[n]=0;this.recordingWorker&&this.recordingWorker.postMessage({cmd:"pushData",data:e})}},t.prototype.ReceiveMessageFromWorker=function(t){var e=t.data;if(!e.hasOwnProperty("type"))return console.log("Worker response is invalid (missing property 'type')",t.data),void this.error("AudioRecorder received invalid message from the worker.");switch(e.type){case"error":this.error(e.msg);case"network-error":this.WorkerNetworkError();break;case"finished":this.WorkerFinished(e);break;default:console.log("Unknown message type: ",e.type,e)}},t.prototype.WorkerFinished=function(t){this.recordingWorker.terminate(),this.recordingWorker=null,this.events.trigger(i.RecordingToolFinished,"audio-recorder");for(var n=[],r=0;r<t.files.length;r++){var o=t.files[r],s=new e.AudioSource(o.url,e.AudioSource.StringToType(o.type));n.push(s)}this.success(n)},t.prototype.WorkerNetworkError=function(){this.events.trigger(i.AudioRecordingUnavailable)},t}();e.AudioRecorder=o}(e=t.AudioData||(t.AudioData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.HTML,r=function(){function t(t,e){t instanceof HTMLElement?this.element=t:this.element=n.CreateElement(t),e&&(this.element.textContent=e)}return t.prototype.GetHTML=function(){return this.element},t.prototype.HasClass=function(t){return this.GetHTML().classList.contains(t)},t.prototype.AddClass=function(t){return this.AddClasses(t)},t.prototype.AddClasses=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=0;n<t.length;n++)this.GetHTML().classList.add(t[n]);return this},t.prototype.RemoveClass=function(t){return this.RemoveClasses(t)},t.prototype.RemoveClasses=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=0;n<t.length;n++)this.GetHTML().classList.remove(t[n]);return this},t}();e.SimpleElement=r;var i=function(t){function e(e,n){t.call(this,"button"),this.AddClass("ui-button"),this.content=new r("span",e),this.GetHTML().appendChild(this.content.GetHTML()),n&&(this.GetHTML().onclick=n)}return __extends(e,t),e.prototype.ChangeContent=function(t){return this.content.GetHTML().innerHTML=t,this},e}(r);e.Button=i;var o=function(t){function e(e,n,i){t.call(this,n,i),this.iconClass=e,this.icon=new r("span","").AddClasses("icon",e),this.AddClass("has-icon"),this.GetHTML().appendChild(this.icon.GetHTML())}return __extends(e,t),e.prototype.ChangeIcon=function(t){return this.icon.RemoveClass(this.iconClass).AddClass(t),this.iconClass=t,this},e}(i);e.IconButton=o;var s=function(t){function e(e,n,r){t.call(this,e,"",r),this.ChangeContent(n),this.AddClass("icon-only-button")}return __extends(e,t),e.prototype.ChangeContent=function(t){return n.SetAttributes(this.GetHTML(),{title:t}),this},e}(o);e.IconOnlyButton=s;var a=function(t){function e(e,n){t.call(this,"h"+e,n)}return __extends(e,t),e}(r);e.Heading=a;var u=function(t){function e(e){t.call(this,2,e)}return __extends(e,t),e}(a);e.H2=u;var c=function(){function t(t,e){this.element=n.CreateElement(t),e&&n.SetAttributes(this.element,{id:e}),this.elements=[]}return Object.defineProperty(t.prototype,"Children",{get:function(){return this.elements},enumerable:!0,configurable:!0}),t.prototype.AddChild=function(t){return this.AddChildren(t)},t.prototype.AddChildren=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=0;n<t.length;n++)this.elements.push(t[n]),this.GetHTML().appendChild(t[n].GetHTML());return this},t.prototype.GetHTML=function(){return this.element},t.prototype.HasClass=function(t){return this.GetHTML().classList.contains(t)},t.prototype.AddClass=function(t){return this.AddClasses(t)},t.prototype.AddClasses=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=0;n<t.length;n++)this.GetHTML().classList.add(t[n]);return this},t.prototype.RemoveClass=function(t){return this.RemoveClasses(t)},t.prototype.RemoveClasses=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=0;n<t.length;n++)this.GetHTML().classList.remove(t[n]);return this},t}();e.Panel=c}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"Left",{get:function(){throw new Error("Not implemented")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Right",{get:function(){throw new Error("Not implemented")},enumerable:!0,configurable:!0}),t}();t.Segment=e;var n=function(t){function e(e,n){t.call(this),this.left=e,this.right=n}return __extends(e,t),Object.defineProperty(e.prototype,"Left",{get:function(){return this.left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Right",{get:function(){return this.right},enumerable:!0,configurable:!0}),e}(e);t.QuadrilateralSegment=n;var r=function(t){function e(e,n){t.call(this,e,n)}return __extends(e,t),e}(n);t.ZeroLengthSegment=r;var i=function(t){function e(e,n){t.call(this),this.left=e,this.right=n}return __extends(e,t),Object.defineProperty(e.prototype,"Left",{get:function(){return this.left.End},set:function(t){this.left.End=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Right",{get:function(){return this.right.End},set:function(t){this.right.End=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LeftBezier",{get:function(){return this.left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RightBezier",{get:function(){return this.right},enumerable:!0,configurable:!0}),e}(e);t.CurvedSegment=i}(e=t.Drawing||(t.Drawing={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.SVG,r=t.Helpers.Vector2,i=t.Helpers.VideoEventType,o=function(){function n(t,e,n,r){this.events=t,this.curved=e,this.color=n,this.wireframe=r,void 0===this.wireframe&&(this.wireframe=!1),this.segments=[],this.pathPoints=[]}return Object.defineProperty(n.prototype,"Segments",{get:function(){return this.segments},set:function(t){this.segments=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LastDrawnSegment",{get:function(){return this.lastDrawnSegment},set:function(t){this.lastDrawnSegment=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LastPoint",{get:function(){return this.pathPoints[this.iterator]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LastButOnePoint",{get:function(){return this.pathPoints[Math.max(0,this.iterator-1)]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LastButTwoPoint",{get:function(){return this.pathPoints[Math.max(0,this.iterator-2)]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Color",{get:function(){return this.color},enumerable:!0,configurable:!0}),n.prototype.StartPath=function(t,n){this.segments=[new e.ZeroLengthSegment(t.clone().add(new r(0,n)),t.clone().add(new r(0,-n)))],this.startPosition=t,this.startRadius=n,this.iterator=-1,this.DrawStartDot(t,n),this.lastDrawnSegment=this.segments[0]},n.prototype.DrawStartDot=function(t,e){throw new Error("Not impelmented")},n.prototype.InitPath=function(t,n){this.segments=[new e.ZeroLengthSegment(n,t)],this.pathPoints.push({Left:n,Right:t}),this.iterator=0},n.prototype.StartDrawingPath=function(t){this.DrawStartDot(t.Left.pointInBetween(t.Right),t.Left.distanceTo(t.Right)/2),this.lastDrawnSegment=t},n.prototype.ExtendPath=function(t,e){var n=this.pathPoints[this.pathPoints.length-1];if(!n.Left.isEqualTo(e)||!n.Right.isEqualTo(t)){var r=this.CalculateSegment(t,e);this.DrawSegment(r),this.events.trigger(i.DrawSegment,r),this.segments.push(r),this.pathPoints.push({Left:e,Right:t}),this.iterator++}},n.prototype.CalculateSegment=function(t,e){return this.curved?this.CalculateCurvedSegment(t,e):this.CalculateQuarilateralSegment(t,e)},n.prototype.CalculateCurvedSegment=function(n,r){var i=t.Helpers.Spline.catmullRomToBezier(this.LastButTwoPoint.Left,this.LastButOnePoint.Left,this.LastPoint.Left,r),o=t.Helpers.Spline.catmullRomToBezier(this.LastButTwoPoint.Right,this.LastButOnePoint.Right,this.LastPoint.Right,n),s=new e.CurvedSegment(i,o);return this.DrawCurvedSegment(s),s},n.prototype.DrawCurvedSegment=function(t){throw new Error("Not implemented")},n.prototype.CalculateQuarilateralSegment=function(t,n){return new e.QuadrilateralSegment(n,t)},n.prototype.DrawQuadrilateralSegment=function(t){throw new Error("Not implemented")},n.prototype.Draw=function(){},n.prototype.DrawSegment=function(t){t instanceof e.CurvedSegment?this.DrawCurvedSegment(t):t instanceof e.QuadrilateralSegment&&this.DrawQuadrilateralSegment(t),this.lastDrawnSegment=t},n.angle=function(t){return Math.atan2(-t.X,t.Y)-Math.PI/2},n.prototype.DrawWholePath=function(){if(this.iterator=0,0!==this.segments.length){var t=this.segments[0].Left.clone().add(this.segments[0].Right).scale(.5),e=t.distanceTo(this.segments[0].Left);for(this.DrawStartDot(t,e),this.lastDrawnSegment=this.segments[0];this.iterator<this.segments.length;)this.DrawSegment(this.segments[this.iterator++]);this.Draw()}},n}();e.Path=o;var s=function(t){function e(e,n,r,i){t.call(this,e,n,r),this.canvas=i}return __extends(e,t),e.prototype.DrawStartDot=function(t,e){this.path=this.CreatePathElement();var i=new r(t.X-e,t.Y),s=new r(t.X+e,t.Y),a=s.pointInBetween(i),u=i.clone().subtract(a),c=s.clone().subtract(a),h=n.ArcString(s,a.distanceTo(s),o.angle(u));this.right=n.MoveToString(s),this.left=n.LineToString(i)+" "+h,this.cap=n.ArcString(i,a.distanceTo(i),o.angle(c)),n.SetAttributes(this.path,{d:this.right+this.cap+this.left}),this.canvas.appendChild(this.path)},e.prototype.InitPath=function(e,n){t.prototype.InitPath.call(this,e,n),this.StartDrawingPath(this.segments[0])},e.prototype.CreatePathElement=function(){var t;return t=this.wireframe?{stroke:this.color,"stroke-width":1}:{fill:this.color},n.CreateElement("path",t)},e.prototype.DrawCurvedSegment=function(t){this.right+=n.CurveToString(t.RightBezier.StartCP,t.RightBezier.EndCP,t.RightBezier.End),this.left=n.CurveToString(t.LeftBezier.EndCP,t.LeftBezier.StartCP,t.LeftBezier.Start)+" "+this.left;var e=t.Right.pointInBetween(t.Left),r=t.Right.clone().subtract(e);this.cap=n.ArcString(t.Left,e.distanceTo(t.Left),o.angle(r))},e.prototype.DrawQuadrilateralSegment=function(t){this.right+=n.LineToString(t.Right),this.left=n.LineToString(this.lastDrawnSegment.Left)+" "+this.left;var e=t.Right.pointInBetween(t.Left),r=t.Right.clone().subtract(e);this.cap=n.ArcString(t.Left,e.distanceTo(t.Left),o.angle(r))},e.prototype.GetPathString=function(){return this.right+this.cap+this.left},e.prototype.Draw=function(){n.SetAttributes(this.path,{d:this.GetPathString()})},e}(o);e.SvgPath=s;var a=function(t){function e(e,n,r,i){t.call(this,e,n,r),this.context=i,this.context.fillStyle=this.color}return __extends(e,t),e.prototype.DrawStartDot=function(t,e){this.context.beginPath(),this.DrawDot(t,e),this.Draw()},e.prototype.DrawDot=function(t,e){this.context.arc(t.X,t.Y,e,0,2*Math.PI,!0)},e.prototype.DrawQuadrilateralSegment=function(t){this.context.moveTo(this.lastDrawnSegment.Right.X,this.lastDrawnSegment.Right.Y),this.context.lineTo(this.lastDrawnSegment.Left.X,this.lastDrawnSegment.Left.Y),this.context.lineTo(t.Left.X,t.Left.Y);var e=t.Left.pointInBetween(t.Right),n=t.Right.clone().subtract(e),r=t.Left.clone().subtract(e);this.context.arc(e.X,e.Y,e.distanceTo(t.Left),o.angle(n),o.angle(r),!1)},e.prototype.DrawCurvedSegment=function(t){this.context.moveTo(t.RightBezier.Start.X,t.RightBezier.Start.Y),this.context.lineTo(t.LeftBezier.Start.X,t.LeftBezier.Start.Y),this.context.bezierCurveTo(t.LeftBezier.StartCP.X,t.LeftBezier.StartCP.Y,t.LeftBezier.EndCP.X,t.LeftBezier.EndCP.Y,t.LeftBezier.End.X,t.LeftBezier.End.Y);var e=t.RightBezier.End.pointInBetween(t.LeftBezier.End),n=t.RightBezier.End.clone().subtract(e),r=t.LeftBezier.End.clone().subtract(e);this.context.arc(e.X,e.Y,e.distanceTo(t.LeftBezier.End),o.angle(n),o.angle(r),!1),this.context.bezierCurveTo(t.RightBezier.EndCP.X,t.RightBezier.EndCP.Y,t.RightBezier.StartCP.X,t.RightBezier.StartCP.Y,t.RightBezier.Start.X,t.RightBezier.Start.Y)},e.prototype.Draw=function(){
this.context.closePath(),this.context.fill(),this.context.beginPath()},e}(o);e.CanvasPath=a}(e=t.Drawing||(t.Drawing={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.HTML,r=function(){function r(t){void 0===t&&(t=!0),this.curved=t}return r.prototype.SetEvents=function(t){this.events=t},r.prototype.CreateCanvas=function(){return this.canvas=n.CreateElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas},r.prototype.Stretch=function(){var e=this.canvas.parentElement,n=e.clientWidth,r=e.clientHeight;this.originalHeight=r,this.originalWidth=n,t.Helpers.HTML.SetAttributes(this.canvas,{width:n,height:r}),this.events.trigger(t.Helpers.VideoEventType.CanvasSize,n,r)},r.prototype.SetupOutputCorrection=function(t,e){var n=this.canvas.width/t,r=this.canvas.height/e,i=Math.min(n,r);return this.context.scale(i,i),i},r.prototype.ClearCanvas=function(t){this.context.fillStyle=t.CssValue,this.context.fillRect(0,0,this.originalWidth,this.originalHeight)},r.prototype.SetCurrentColor=function(t){this.currentColor=t},r.prototype.CreatePath=function(t){return new e.CanvasPath(t,this.curved,this.currentColor.CssValue,this.context)},r}();e.CanvasDrawer=r}(e=t.Drawing||(t.Drawing={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.SVG,r=function(){function r(t){void 0===t&&(t=!0),this.curved=t}return r.prototype.SetEvents=function(t){this.events=t},r.prototype.CreateCanvas=function(){this.svg=n.CreateElement("svg");var t=n.CreateElement("g");return this.bg=n.CreateElement("rect",{id:"background"}),t.appendChild(this.bg),this.svg.appendChild(t),this.canvas=n.CreateElement("g",{id:"canvas"}),this.svg.appendChild(this.canvas),this.svg},r.prototype.Stretch=function(){var e=this.svg.parentElement,n=e.clientWidth,r=e.clientHeight;t.Helpers.SVG.SetAttributes(this.svg,{width:n,height:r}),t.Helpers.SVG.SetAttributes(this.bg,{width:n,height:r}),this.events.trigger(t.Helpers.VideoEventType.CanvasSize,n,r)},r.prototype.ClearCanvas=function(t){for(;this.canvas.firstChild;)this.canvas.removeChild(this.canvas.firstChild);n.SetAttributes(this.bg,{fill:t.CssValue})},r.prototype.SetCurrentColor=function(t){this.currentColor=t},r.prototype.CreatePath=function(t){return new e.SvgPath(t,this.curved,this.currentColor.CssValue,this.canvas)},r.prototype.SetupOutputCorrection=function(e,r){var i=this.svg.clientWidth/e,o=this.svg.clientHeight/r,s=Math.min(i,o);return n.SetAttributes(this.svg,{viewBox:"0 0 "+e+" "+r}),s===i?this.events.trigger(t.Helpers.VideoEventType.CursorOffset,new t.Helpers.Vector2(0,(this.svg.clientHeight-r*s)/2)):this.events.trigger(t.Helpers.VideoEventType.CursorOffset,new t.Helpers.Vector2((this.svg.clientWidth-e*s)/2,0)),s},r}();e.SVGDrawer=r}(e=t.Drawing||(t.Drawing={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.Vector2,r=t.Helpers.VideoEventType,i=function(){function t(t,e,n,r,i,o){var a=this;this.events=t,this.pathFactory=e,this.slowSimulation=n,this.minBrushSize=r,this.maxBrushSize=i,this.minMass=1,this.maxMass=10,this.minFriction=.4,this.maxFriction=.6,this.brushes={},this.oneFrame=1e3/60,this.cursor=new s(!0,o),n===!0?requestAnimationFrame(function(t){a.lastAnimationTime=t,a.Tick(t)}):requestAnimationFrame(function(){return a.TickWhile()})}return t.prototype.SetBrushSize=function(t){this.currentBrushSize=t},t.prototype.interpolateMass=function(t){return this.minMass+(this.maxMass-this.minMass)*(t-this.minBrushSize)/(this.maxBrushSize-this.minBrushSize)},t.prototype.interpolateFriction=function(t){return this.maxFriction-(this.maxFriction-this.minFriction)*(t-this.minBrushSize)/(this.maxBrushSize-this.minBrushSize)},t.prototype.GetBrush=function(t){return this.brushes[t]||(this.brushes[t]=new o(this.interpolateMass(t),this.interpolateFriction(t),t)),this.brushes[t]},t.prototype.ObserveCursorMovement=function(t){try{var e=new n(t.X,t.Y);t.Pressure>0?this.lastState&&0!==this.lastState.Pressure?this.NextPoint(e,t.Pressure):(this.path=this.pathFactory(),this.events.trigger(r.StartPath,this.path),this.StartPath(e,t.Pressure)):this.lastState&&this.lastState.Pressure>0&&this.EndPath(e,this.lastState.Pressure)}catch(i){console.log("ProcessNewState error: ",i)}this.lastState=t},t.prototype.StartPath=function(t,e){this.cursor.Reset(t,this.GetBrush(this.currentBrushSize.Size)),this.position=t,this.pressure=e,this.cursor.StartPath(this.path,t,e)},t.prototype.NextPoint=function(t,e){this.position=t,this.pressure=e},t.prototype.EndPath=function(t,e){this.position=t},t.prototype.TickWhile=function(){var t=this;if(this.position){var e=0,n=0;do e=this.cursor.ApplyForce(this.position),n+=e,n>this.currentBrushSize.Size&&(this.cursor.Draw(this.path,this.pressure),n=0);while(e>0);n>0&&this.cursor.Draw(this.path,this.pressure),this.position=null}requestAnimationFrame(function(e){return t.TickWhile()})},t.prototype.Tick=function(t){var e=this;this.path&&(this.cursor.ApplyForce(this.position)>0?this.cursor.Draw(this.path,this.pressure):this.position||(this.path=null)),this.lastAnimationTime=t,requestAnimationFrame(function(t){return e.Tick(t)})},t}();e.DynaDraw=i;var o=function(){function t(t,e,n){this.mass=t,this.friction=e,this.size=n}return Object.defineProperty(t.prototype,"Mass",{get:function(){return this.mass},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Friction",{get:function(){return this.friction},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){return this.size},enumerable:!0,configurable:!0}),t}(),s=function(){function t(t,e){this.calculateSpeed=t,this.timer=e}return t.prototype.Reset=function(t,e){this.brush=e,this.position=t.clone(),this.startPosition=t.clone(),this.previousPosition=t.clone(),this.previousPressure=-1,this.mousePosition=t.clone(),this.acceleration=new n(0,0),this.velocity=new n(0,0),this.firstSegment=!0},t.prototype.ApplyForce=function(t){if(null!==t){var e=t.clone().subtract(this.position);this.acceleration=e.clone().scale(1/this.brush.Mass),this.velocity.add(this.acceleration),this.mousePosition=t}return this.velocity.scale(1-this.brush.Friction),this.velocity.getSizeSq()<1?0:(t=null,e=null,this.acceleration=null,this.angle=this.velocity.getNormal(),this.position.add(this.velocity),this.velocity.getSizeSq())},t.prototype.Draw=function(t,e){var n=this.calculateSpeed===!0?this.velocity.getSize()/(this.brush.Size*this.brush.Size):0,r=this.getRadius(e,n);this.angle.scale(r),this.firstSegment&&(t.InitPath(this.startPosition.clone().add(this.angle),this.startPosition.clone().subtract(this.angle)),this.firstSegment=!1),t.ExtendPath(this.position.clone().add(this.angle),this.position.clone().subtract(this.angle)),t.Draw()},t.prototype.StartPath=function(t,e,n){t.StartPath(e,this.getRadius(n,0))},t.prototype.getRadius=function(t,e){this.previousPressure<0&&(this.previousPressure=t);var n=this.interpolatePressure(t),r=this.speedFactor(e)*this.brush.Size*n/2;return this.previousPosition=this.position.clone(),this.previousPressure=n,r},t.prototype.interpolatePressure=function(t){var e=this.position.distanceTo(this.previousPosition),n=this.position.distanceTo(this.mousePosition);return 0===e&&0===n?t:e/(e+n)*(t-this.previousPressure)+this.previousPressure},t.prototype.speedFactor=function(t){return Math.max(1-t,.4)},t.threshold=.001,t}()}(e=t.Drawing||(t.Drawing={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(t){this.cssValue=t}return Object.defineProperty(t.prototype,"CssValue",{get:function(){return this.cssValue},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BackgroundColor",{get:function(){return new t(this.backgroundPrototype.CssValue)},set:function(t){this.backgroundPrototype=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ForegroundColor",{get:function(){return new t(this.foregroundPrototype.CssValue)},set:function(t){this.foregroundPrototype=t},enumerable:!0,configurable:!0}),t.backgroundPrototype=new t("#111"),t.foregroundPrototype=new t("#fff"),t}();t.Color=e}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.Vector2,r=function(r){function i(t){r.call(this,"div"),this.events=t,this.radius=20,this.stroke=3,this.position=new n(0,0),this.offset=new n(0,0),this.CreateHTML(),this.scalingFactor=1,this.size=null}return __extends(i,r),Object.defineProperty(i.prototype,"Offset",{set:function(t){this.offset=t},enumerable:!0,configurable:!0}),i.prototype.CreateHTML=function(){var n=this;this.svg=t.Helpers.SVG.CreateElement("svg",{width:2*this.radius,height:2*this.radius}),this.GetHTML().appendChild(this.svg),this.bgColor=e.Color.BackgroundColor,this.color=e.Color.ForegroundColor,this.dot=t.Helpers.SVG.CreateDot(new t.Helpers.Vector2(this.radius,this.radius),this.radius-this.stroke,this.bgColor.CssValue),t.Helpers.SVG.SetAttributes(this.dot,{stroke:this.color.CssValue,"stroke-width":this.stroke}),this.svg.appendChild(this.dot),this.GetHTML().style.position="absolute",this.GetHTML().style.background="transparent",this.GetHTML().style.lineHeight="0",this.events.on(t.Helpers.VideoEventType.ClearCanvas,function(e){n.bgColor=e,t.Helpers.SVG.SetAttributes(n.dot,{fill:n.bgColor.CssValue}),n.ChangeColor(n.color)})},i.prototype.MoveTo=function(e,n){this.GetHTML().style.left=e*this.scalingFactor-this.radius-this.stroke+this.offset.X+"px",this.GetHTML().style.top=n*this.scalingFactor-this.radius-this.stroke+this.offset.Y+"px",this.position=new t.Helpers.Vector2(e,n)},i.prototype.ChangeColor=function(n){n.CssValue===this.bgColor.CssValue&&(n=n.CssValue===e.Color.ForegroundColor.CssValue?e.Color.BackgroundColor:e.Color.ForegroundColor),t.Helpers.SVG.SetAttributes(this.dot,{stroke:n.CssValue}),this.color=n},i.prototype.ChangeSize=function(e){this.size=e;var n=this.radius;this.radius=e.Size*this.scalingFactor/2-2;var r=2*(this.radius+this.stroke);t.Helpers.SVG.SetAttributes(this.svg,{width:r,height:r});var i=n-this.radius;this.MoveTo(this.position.X+i,this.position.Y+i),t.Helpers.SVG.SetAttributes(this.dot,{cx:r/2,cy:r/2,r:Math.max(1,this.radius-this.stroke)})},i.prototype.SetScalingFactor=function(t){this.scalingFactor=t,this.size&&this.ChangeSize(this.size)},i}(e.SimpleElement);e.Cursor=r}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.HTML,r=t.Helpers.VideoEventType,i=function(t){function i(i,o){var s=this;t.call(this,"div",i),this.events=o,n.SetAttributes(this.GetHTML(),{"class":"vector-video-board"}),this.cursor=new e.Cursor(o),this.AddChild(this.cursor),n.SetAttributes(this.GetHTML(),{position:"relative"}),o.on(r.CursorState,function(t){return s.UpdateCursorPosition(t)}),o.on(r.CursorState,function(t){return s.UpdateCursorPosition(t)}),o.on(r.ChangeBrushSize,function(t){return s.UpdateCursorSize(t)}),o.on(r.ChangeColor,function(t){return s.UpdateCursorColor(t)}),o.on(r.ChangeColor,function(t){return s.UpdateCursorColor(t)}),o.on(r.CanvasScalingFactor,function(t){return s.UpdateCursorScale(t)}),o.on(r.CursorOffset,function(t){return s.cursor.Offset=t})}return __extends(i,t),Object.defineProperty(i.prototype,"Width",{get:function(){return this.GetHTML().clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Height",{get:function(){return this.GetHTML().clientHeight},set:function(t){this.GetHTML().clientHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsRecording",{set:function(t){t?this.GetHTML().classList.add("recording"):this.GetHTML().classList.remove("recording")},enumerable:!0,configurable:!0}),i.prototype.UpdateCursorPosition=function(t){this.cursor.MoveTo(t.X,t.Y)},i.prototype.UpdateCursorSize=function(t){this.cursor.ChangeSize(t)},i.prototype.UpdateCursorColor=function(t){this.cursor.ChangeColor(t)},i.prototype.UpdateCursorScale=function(t){this.cursor.SetScalingFactor(t)},i}(e.Panel);e.Board=i}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(t){this.size=t}return Object.defineProperty(t.prototype,"Size",{get:function(){return this.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Unit",{get:function(){return"px"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CssValue",{get:function(){return""+this.Size+this.Unit},enumerable:!0,configurable:!0}),t}();t.BrushSize=e}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.VideoEventType,r=function(e){function r(t,n,r){var i=this;e.call(this,""),this.events=t,this.SetColor(n),this.GetHTML().onclick=function(t){return r?r():i.ChangeColor(t)}}return __extends(r,e),r.prototype.ChangeColor=function(t){r.active&&r.active.GetHTML().classList.remove("active"),this.GetHTML().classList.add("active"),r.active=this,this.events.trigger(n.ChangeColor,this.color)},r.prototype.SetColor=function(e){this.color=e,t.Helpers.HTML.SetAttributes(this.GetHTML(),{"class":"option","data-color":e.CssValue,style:"background-color: "+e.CssValue})},r}(e.Button);e.ChangeColorButton=r;var i=function(e){function r(n,r){var i=this;e.call(this,""),this.events=n,this.size=r;var o=t.Helpers.HTML.CreateElement("span",{style:"width: "+r.CssValue+";	\n						height: "+r.CssValue+";\n						border-radius: "+r.Size/2+r.Unit+"; \n						display: inline-block;\n						background: black;\n						margin-top: "+-r.Size/2+r.Unit+";","class":"dot","data-size":r.Size});this.GetHTML().appendChild(o),t.Helpers.HTML.SetAttributes(this.GetHTML(),{"class":"option","data-size":r.Size}),this.GetHTML().onclick=function(t){return i.ChangeSize(t)}}return __extends(r,e),r.prototype.ChangeSize=function(t){t.preventDefault(),r.active&&r.active.GetHTML().classList.remove("active"),this.GetHTML().classList.add("active"),r.active=this,this.events.trigger(n.ChangeBrushSize,this.size)},r}(e.Button);e.ChangeBrushSizeButton=i}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.VideoEventType,r=function(r){function i(t,n){var i=this;r.call(this,"div",t),this.events=n,this.length=0,this.GetHTML().classList.add("ui-progressbar");var o=new e.Panel("div");o.AddClass("ui-progress"),o.AddChild(new e.SimpleElement("div").AddClass("ui-current-time")),this.progresbar=o,this.AddChild(o),o=null;var s=new e.SimpleElement("div");s.AddClass("ui-buffer"),this.bufferbar=s,this.AddChild(s),s=null,this.arrow=new e.SimpleElement("div","0:00"),this.arrow.AddClass("ui-arrow"),this.AddChild(this.arrow),this.Sync(0),this.GetHTML().onclick=function(t){return i.OnClick(t)},this.GetHTML().onmousemove=function(t){return i.OnMouseMove(t)}}return __extends(i,r),Object.defineProperty(i.prototype,"Length",{set:function(t){this.length=t},enumerable:!0,configurable:!0}),i.prototype.OnClick=function(t){var e=(t.clientX-this.GetHTML().clientLeft)/this.GetHTML().clientWidth*this.length;this.SkipTo(e)},i.prototype.OnMouseMove=function(e){var n=(e.clientX-this.GetHTML().clientLeft)/this.GetHTML().clientWidth,r=t.Helpers.millisecondsToString(n*this.length);this.arrow.GetHTML().textContent=r,this.arrow.GetHTML().style.left=100*n+"%";var i=this.arrow.GetHTML().getBoundingClientRect();i.left<0?this.arrow.GetHTML().style.left=i.width/2+"px":i.right>this.GetHTML().getBoundingClientRect().right&&(this.arrow.GetHTML().style.left=this.GetHTML().getBoundingClientRect().right-i.width/2+"px")},i.prototype.Sync=function(t){this.progresbar.GetHTML().style.width=this.length>0?t/this.length*100+"%":"O%"},i.prototype.SetBuffer=function(t){this.bufferbar.GetHTML().style.width=this.length>0?t/this.length*100+"%":"O%"},i.prototype.SkipTo=function(t){this.events.trigger(n.JumpTo,t/this.length),this.Sync(t)},i}(e.Panel);e.TimeLine=r}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.VideoEventType,r=function(r){function i(t,e){var i=this;r.call(this,"div",t+"-player"),this.id=t,this.events=e,this.isBusy=!1,this.tickingInterval=200,this.isMuted=!1,this.AddClass("vector-video-wrapper"),this.board=this.CreateBoard(),this.AddChild(this.board),this.events.on(n.Start,function(){return i.StartPlaying()}),this.events.on(n.Pause,function(){return i.PausePlaying()}),this.events.on(n.ReachEnd,function(){return i.ReachedEnd()}),this.events.on(n.JumpTo,function(){return i.JumpTo()}),this.events.on(n.ClearCanvas,function(t){return i.GetHTML().style.backgroundColor=t.CssValue}),this.isPlaying=!1,this.reachedEnd=!1}return __extends(i,r),i.prototype.CreateControls=function(r){var i=this;this.timeline=this.CreateTimeLine(),this.hidingButton=new e.IconOnlyButton(r?"icon-show":"icon-hide","",function(t){return i.ToggleAutohiding()}).AddClasses("autohiding-toggle"),this.controls=new e.Panel("div",this.id+"-controls").AddClasses("ui-controls","ui-control").AddChildren(this.CreateButtonsPanel(),this.timeline,this.CreateTimeStatus(),this.CreateAudioControls()),!!r&&this.controls.AddClass("autohide"),this.AddChildren(new e.Panel("div").AddClass("ui-controls-wrapper").AddChildren(this.controls,this.hidingButton)),this.events.on(n.VideoInfoLoaded,function(e){i.videoDuration=e.Length,i.totalTime.GetHTML().textContent=t.Helpers.millisecondsToString(e.Length),i.timeline.Length=e.Length}),this.events.on(n.BufferStatus,function(t){return i.timeline.SetBuffer(1e3*t)}),this.BindKeyboardShortcuts()},i.prototype.SetBusyText=function(e){t.Helpers.HTML.SetAttributes(this.GetHTML(),{"data-busy-string":e})},i.prototype.BindKeyboardShortcuts=function(){var t=this,e=32,n=37,r=39,i=5e3;window.onkeyup=function(o){switch(o.keyCode){case e:t.PlayPause();break;case n:t.timeline.SkipTo(Math.max(0,t.Timer.CurrentTime()-i));break;case r:t.timeline.SkipTo(Math.min(t.Timer.CurrentTime()+i,t.videoDuration))}}},i.prototype.AcceptCanvas=function(t){this.board.GetHTML().appendChild(t)},i.prototype.CreateBoard=function(){var t=this,n=new e.Board(this.id+"-board",this.events);return n.GetHTML().onclick=function(){return t.PlayPause()},n},i.prototype.CreateButtonsPanel=function(){var t=this;return this.playPauseButton=new e.IconOnlyButton("icon-play",this.Localization.Play,function(e){return t.PlayPause()}),new e.Panel("div").AddChildren(new e.H2(this.Localization.ControlPlayback),this.playPauseButton).AddClass("ui-controls-panel")},i.prototype.PlayPause=function(){return!this.isBusy&&this.controls?this.reachedEnd?(this.reachedEnd=!1,this.timeline.SkipTo(0),void this.events.trigger(n.Start)):void(this.isPlaying===!0?(this.PausePlaying(),this.events.trigger(n.Pause)):(this.StartPlaying(),this.events.trigger(n.Start))):void 0},i.prototype.JumpTo=function(){this.controls&&this.reachedEnd===!0&&(this.reachedEnd=!1,this.playPauseButton.ChangeIcon("icon-play"))},i.prototype.StartPlaying=function(){var t=this;this.controls&&this.isPlaying===!1&&(this.isPlaying=!0,this.playPauseButton.ChangeIcon("icon-pause"),this.playPauseButton.ChangeContent(this.Localization.Pause),this.AddClass("playing"),this.ticking=setInterval(function(){return t.UpdateCurrentTime()},this.tickingInterval))},i.prototype.PausePlaying=function(){this.controls&&(this.isPlaying=!1,this.playPauseButton.ChangeIcon("icon-play"),this.playPauseButton.ChangeContent(this.Localization.Play),this.RemoveClass("playing"),clearInterval(this.ticking))},i.prototype.CreateTimeLine=function(){return new e.TimeLine(this.id+"-timeline",this.events)},i.prototype.CreateTimeStatus=function(){return this.currentTime=new e.SimpleElement("span","0:00"),this.totalTime=new e.SimpleElement("span","0:00"),new e.Panel("div").AddChildren(new e.H2(this.Localization.TimeStatus),new e.Panel("div").AddChildren(this.currentTime,new e.SimpleElement("span"," / "),this.totalTime).AddClass("ui-time")).AddClass("ui-controls-panel")},i.prototype.UpdateCurrentTime=function(e){this.currentTime.GetHTML().textContent=t.Helpers.millisecondsToString(e?e:this.Timer.CurrentTime()),this.timeline.Sync(e?e:this.Timer.CurrentTime())},i.prototype.ReachedEnd=function(){this.controls&&(this.PausePlaying(),this.playPauseButton.ChangeIcon("icon-replay").ChangeContent(this.Localization.Replay),this.reachedEnd=!0,this.UpdateCurrentTime())},i.prototype.Busy=function(){this.AddClass("busy"),this.isBusy=!0},i.prototype.Ready=function(){this.RemoveClass("busy"),this.isBusy=!1},i.prototype.CreateAudioControls=function(){var t=this;return new e.Panel("div",this.id+"-audio").AddChildren(new e.H2(this.Localization.VolumeControl),new e.Panel("div",this.id+"-audio-controls").AddChildren(this.volumeDownBtn=new e.IconOnlyButton("icon-volume-down",this.Localization.VolumeDown,function(e){return t.VolumeDown()}),this.volumeUpBtn=new e.IconOnlyButton("icon-volume-up",this.Localization.VolumeUp,function(e){return t.VolumeUp()}),this.volumeOffBtn=new e.IconOnlyButton("icon-volume-off",this.Localization.Mute,function(e){return t.Mute()})).AddClass("btn-group")).AddClasses("ui-controls-panel","vector-video-audio-controls")},i.prototype.VolumeUp=function(){this.events.trigger(n.VolumeUp)},i.prototype.VolumeDown=function(){this.events.trigger(n.VolumeDown)},i.prototype.Mute=function(){this.isMuted?(this.volumeDownBtn.GetHTML().removeAttribute("disabled"),this.volumeUpBtn.GetHTML().removeAttribute("disabled"),this.volumeOffBtn.RemoveClass("active")):(t.Helpers.HTML.SetAttributes(this.volumeDownBtn.GetHTML(),{disabled:"disabled"}),t.Helpers.HTML.SetAttributes(this.volumeUpBtn.GetHTML(),{disabled:"disabled"}),this.volumeOffBtn.AddClass("active")),this.isMuted=!this.isMuted,this.events.trigger(n.Mute)},i.prototype.ToggleAutohiding=function(){this.controls.HasClass("autohide")?(this.controls.RemoveClass("autohide"),this.hidingButton.ChangeIcon("icon-hide")):(this.controls.AddClass("autohide"),this.hidingButton.ChangeIcon("icon-show"))},i}(e.Panel);e.PlayerUI=r}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=function(n){function r(t,e){n.call(this,"div",t+"-recorder"),this.id=t,this.events=e,this.tickingInterval=100,this.AddClass("vector-video-wrapper"),this.isRecording=!1,this.isBusy=!1,this.micIsMuted=!1}return __extends(r,n),Object.defineProperty(r.prototype,"Width",{get:function(){return this.board.Width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Height",{get:function(){return this.board.Height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"BackgroundColor",{get:function(){return e.Color.BackgroundColor.CssValue},enumerable:!0,configurable:!0}),r.prototype.CreateHTML=function(t,n,r){this.board=this.CreateBoard(),this.controls=new e.Panel("div",this.id+"-controls").AddChildren(this.CreateButtonsPanel().AddClass("ui-controls-panel"),this.CreateColorsPanel(n).AddClass("ui-controls-panel"),this.CreateBrushSizesPanel(r).AddClass("ui-controls-panel"),this.CreateEraserPanel().AddClass("ui-controls-panel"),this.CreateEraseAllPanel().AddClass("ui-controls-panel"),this.CreateMicPanel().AddClass("ui-controls-panel")).AddClasses("ui-controls","ui-control"),!!t&&this.controls.AddClass("autohide"),this.AddChildren(this.board,new e.Panel("div").AddClass("ui-controls-wrapper").AddChild(this.controls))},r.prototype.Busy=function(){this.AddClass("busy"),this.isBusy=!0},r.prototype.Ready=function(){this.RemoveClass("busy"),this.isBusy=!1},r.prototype.SetBusyText=function(e){t.Helpers.HTML.SetAttributes(this.GetHTML(),{"data-busy-string":e})},r.prototype.AcceptCanvas=function(t){this.board.GetHTML().appendChild(t)},r.prototype.CreateBoard=function(){var t=new e.Board(this.id+"-board",this.events);return t},r.prototype.CreateButtonsPanel=function(){var n=this,r=new e.Panel("div",this.id+"-panels");return this.recPauseButton=new e.IconButton("icon-rec",this.Localization.Record,function(t){return n.RecordPause()}),this.uploadButton=new e.IconButton("icon-upload",this.Localization.Upload,function(t){return n.InitializeUpload()}),t.Helpers.HTML.SetAttributes(this.uploadButton.GetHTML(),{disabled:"disabled"}),r.AddChildren(new e.H2(this.Localization.RecPause),new e.Panel("div").AddClass("btn-group").AddChildren(this.recPauseButton,this.uploadButton)),r},r.prototype.RecordPause=function(){this.isRecording===!0?(this.PauseRecording(),this.uploadButton.GetHTML().removeAttribute("disabled"),this.RemoveClass("recording")):(this.StartRecording(),t.Helpers.HTML.SetAttributes(this.uploadButton.GetHTML(),{disabled:"disabled"}),this.AddClass("recording"))},r.prototype.StartRecording=function(){var e=this;this.isRecording===!1&&(this.isRecording=!0,this.recPauseButton.ChangeIcon("icon-pause"),this.board.IsRecording=!0,this.ticking=setInterval(function(){return e.Tick()},this.tickingInterval),this.events.trigger(t.Helpers.VideoEventType.Start))},r.prototype.PauseRecording=function(){this.isRecording===!0&&(this.isRecording=!1,this.recPauseButton.ChangeIcon("icon-rec"),this.board.IsRecording=!1,clearInterval(this.ticking),this.events.trigger(t.Helpers.VideoEventType.Pause))},r.prototype.Tick=function(){this.recPauseButton.ChangeContent(t.Helpers.millisecondsToString(this.Timer.CurrentTime()))},r.prototype.InitializeUpload=function(){t.Helpers.HTML.SetAttributes(this.recPauseButton.GetHTML(),{disabled:"disabled"}),t.Helpers.HTML.SetAttributes(this.uploadButton.GetHTML(),{disabled:"disabled"}),this.events.trigger(t.Helpers.VideoEventType.StartUpload)},r.prototype.CreateColorsPanel=function(t){for(var n=new e.Panel("div").AddClass("btn-group"),r=0;r<t.length;r++){var i=new e.ChangeColorButton(this.events,t[r]);n.AddChild(i)}return new e.Panel("div").AddClass("color-pallete").AddChildren(new e.H2(this.Localization.ChangeColor),n)},r.prototype.CreateBrushSizesPanel=function(t){for(var n=new e.Panel("div").AddClass("btn-group"),r=0;r<t.length;r++)n.AddChild(new e.ChangeBrushSizeButton(this.events,t[r]));return new e.Panel("div").AddClass("brush-sizes").AddChildren(new e.H2(this.Localization.ChangeSize),n)},r.prototype.CreateEraserPanel=function(){return this.switchToEraserButton=new e.ChangeColorButton(this.events,e.Color.BackgroundColor),new e.Panel("div",this.id+"-erase").AddChildren(new e.H2(this.Localization.Erase),this.switchToEraserButton)},r.prototype.CreateEraseAllPanel=function(){var n=this,r=new e.Panel("div",this.id+"-erase"),i=new e.H2(this.Localization.EraseAll);return r.AddChild(i),this.eraseAllButton=new e.ChangeColorButton(this.events,e.Color.BackgroundColor,function(){return n.EraseAll()}),this.events.on(t.Helpers.VideoEventType.ChangeColor,function(t){n.currentColor=t,n.eraseAllButton.SetColor(t)}),r.AddChild(this.eraseAllButton),r},r.prototype.EraseAll=function(){this.events.trigger(t.Helpers.VideoEventType.ClearCanvas,this.currentColor),this.switchToEraserButton.SetColor(this.currentColor)},r.prototype.CreateMicPanel=function(){var n=this;return this.micButton=new e.IconOnlyButton("icon-mic-off",this.Localization.AudioRecordingUnavailable,function(){return n.MuteMic()}),t.Helpers.HTML.SetAttributes(this.micButton.GetHTML(),{disabled:"disabled"}),this.events.on(t.Helpers.VideoEventType.AudioRecordingAvailable,function(){n.micButton.GetHTML().removeAttribute("disabled"),n.micIsMuted||n.micButton.ChangeIcon("icon-mic").ChangeContent(n.Localization.AudioRecordingAvailable)}),this.events.on(t.Helpers.VideoEventType.AudioRecordingUnavailable,function(){n.micButton.ChangeIcon("icon-mic-off").ChangeContent(n.Localization.AudioRecordingUnavailable),t.Helpers.HTML.SetAttributes(n.micButton.GetHTML(),{disabled:"disabled"})}),new e.Panel("div").AddChildren(new e.H2(this.Localization.AudioRecording),this.micButton)},r.prototype.MuteMic=function(){this.events.trigger(t.Helpers.VideoEventType.MuteAudioRecording),this.micIsMuted=!this.micIsMuted,this.micIsMuted?this.micButton.ChangeIcon("icon-mic-off"):this.micButton.ChangeIcon("icon-mic")},r}(e.Panel);e.RecorderUI=n}(e=t.UI||(t.UI={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.VideoEventType,r=function(){function t(t,e){this.time=t,this.lastErase=e,this.initCommands=[],this.commands=[],this.cmdIterator=0}return Object.defineProperty(t.prototype,"StartTime",{get:function(){return this.time},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastErase",{get:function(){return this.lastErase},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentCommand",{get:function(){return this.commands[this.cmdIterator]},enumerable:!0,configurable:!0}),t.prototype.PeekNextCommand=function(){return this.commands[this.cmdIterator+1]},t.prototype.MoveNextCommand=function(){this.cmdIterator++},t.prototype.Rewind=function(){this.cmdIterator=0},t.prototype.ExecuteInitCommands=function(t){for(var e=0;e<this.initCommands.length;e++)this.initCommands[e].Execute(t)},t.prototype.GetCommand=function(t){return t<this.commands.length?this.commands[t]:null},t.prototype.PushCommand=function(t){this.commands.push(t)},Object.defineProperty(t.prototype,"Commands",{get:function(){return this.commands},set:function(t){this.commands=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"InitCommands",{get:function(){return this.initCommands},set:function(t){this.initCommands=t},enumerable:!0,configurable:!0}),t.prototype.Render=function(t){throw new Error("Not implemented")},t}();e.Chunk=r;var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.Render=function(){},e}(r);e.VoidChunk=i;var o=function(t){function e(e,n,r){t.call(this,n,r),this.path=e}return __extends(e,t),Object.defineProperty(e.prototype,"Path",{get:function(){return this.path},enumerable:!0,configurable:!0}),e.prototype.Render=function(t){t.trigger(n.DrawPath)},e}(r);e.PathChunk=o;var s=function(t){function e(e,n,r){t.call(this,n,r),this.color=e}return __extends(e,t),Object.defineProperty(e.prototype,"Color",{get:function(){return this.color},enumerable:!0,configurable:!0}),e.prototype.ExecuteInitCommands=function(e){this.Render(e),t.prototype.ExecuteInitCommands.call(this,e)},e.prototype.Render=function(t){t.trigger(n.ClearCanvas,this.color)},e}(r);e.EraseChunk=s}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.VideoEventType,r=function(){function t(t){this.time=t}return Object.defineProperty(t.prototype,"Time",{get:function(){return this.time},enumerable:!0,configurable:!0}),t.prototype.Execute=function(t){throw new Error("Not implemented")},t.prototype.Clone=function(){throw new Error("Not implemented")},t}();e.Command=r;var i=function(e){function r(t,n,r,i){e.call(this,i),this.x=t,this.y=n,this.p=r}return __extends(r,e),Object.defineProperty(r.prototype,"X",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Y",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"P",{get:function(){return this.p},enumerable:!0,configurable:!0}),r.prototype.Execute=function(e){e.trigger(n.CursorState,new t.Helpers.CursorState(this.Time,this.x,this.y,this.p))},r.prototype.Clone=function(){return new r(this.x,this.y,this.p,this.Time)},r}(r);e.MoveCursor=i;var o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.Execute=function(t){t.trigger(n.DrawSegment)},e.prototype.Clone=function(){return new e(this.Time)},e}(r);e.DrawNextSegment=o;var s=function(t){function e(e,n){t.call(this,n),this.color=e}return __extends(e,t),Object.defineProperty(e.prototype,"Color",{get:function(){return this.color},enumerable:!0,configurable:!0}),e.prototype.Execute=function(t){t.trigger(n.ChangeColor,this.color)},e.prototype.Clone=function(){return new e(this.color,this.Time)},e}(r);e.ChangeBrushColor=s;var a=function(t){function e(e,n){
t.call(this,n),this.size=e}return __extends(e,t),Object.defineProperty(e.prototype,"Size",{get:function(){return this.size},enumerable:!0,configurable:!0}),e.prototype.Execute=function(t){t.trigger(n.ChangeBrushSize,this.size)},e.prototype.Clone=function(){return new e(this.size,this.Time)},e}(r);e.ChangeBrushSize=a;var u=function(t){function e(e,n){t.call(this,n),this.color=e}return __extends(e,t),Object.defineProperty(e.prototype,"Color",{get:function(){return this.color},enumerable:!0,configurable:!0}),e.prototype.Execute=function(t){t.trigger(n.ClearCanvas,this.color)},e.prototype.Clone=function(){return new e(this.color,this.Time)},e}(r);e.ClearCanvas=u}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(){}return t}();t.Metadata=e}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n=t.Helpers.VideoEventType,r=t.Helpers.CursorState,i=function(){function t(t,e,n){this.events=t,this.board=e,this.timer=n,this.isHoveringOverUIControl=!1}return t.SelectBestMethod=function(t,n,r,i){var o,s=e.WacomTablet.IsAvailable();return null!==s?(o=new e.WacomTablet(t,n,i,s),console.log("Wacom WebPAPI is used")):window.hasOwnProperty("PointerEvent")?(o=new e.PointerEventsAPI(t,n,i),console.log("Pointer Events API is used")):e.AppleForceTouch.isAvailable()?(o=new e.AppleForceTouch(t,n,r,i),console.log("Apple Force Touch Events over Touch Events API is used")):(o=new e.TouchEventsAPI(t,n,r,i),console.log("Touch Events API are used.")),o.InitControlsAvoiding(),o},t.prototype.getCursor=function(){return this.cursor},t.prototype.InitControlsAvoiding=function(){for(var t=this,e=document.getElementsByClassName("ui-control-panel"),n=0;n<e.length;n++){var r=e[n];r.onmouseover=function(e){return t.isHoveringOverUIControl=!0},r.onmouseout=function(e){return t.isHoveringOverUIControl=!1}}},t.prototype.GetPressure=function(){return this.isDown===!0&&this.isInside===!0?1:0},t.prototype.onMove=function(t){this.cursor=this.getCursorPosition(t),this.ReportAction()},t.prototype.onDown=function(t){this.isHoveringOverUIControl===!1&&(this.isDown=!0,this.cursor=this.getCursorPosition(t),this.ReportAction())},t.prototype.onUp=function(t){this.isDown=!1,this.cursor=this.getCursorPosition(t),this.ReportAction()},t.prototype.onLeave=function(t){this.GetPressure()>0&&(this.onMove(t),this.isDown=!1,this.onMove(t),this.isDown=!0),this.isInside=!1},t.prototype.onOver=function(t){this.isInside=!0},t.prototype.onLooseFocus=function(t){this.isInside=!1,this.isDown=!1},t.prototype.getCursorPosition=function(t){return(void 0==t.clientX||void 0==t.clientY)&&console.log("Wrong 'getCursorPosition' parameter. Event data required."),{x:t.clientX,y:t.clientY}},t.prototype.ReportAction=function(){var t=new r(this.timer.CurrentTime(),this.cursor.x,this.cursor.y,this.GetPressure());this.events.trigger(n.CursorState,t)},t}();e.PointingDevice=i}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(t){function e(e,n,r){var i=this;t.call(this,e,n,r),this.board.addEventListener("pointermove",function(t){return i.onPointerMove(t)}),this.board.addEventListener("pointerdown",function(t){return i.onPointerDown(t)}),this.board.addEventListener("pointerup",function(t){return i.onPointerUp(t)}),this.board.addEventListener("pointerleave",function(t){return i.onPointerLeave(t)}),this.board.addEventListener("pointerenter",function(t){return i.onPointerLeave(t)}),this.board.addEventListener("pointerover",function(t){return i.onPointerOver(t)}),this.currentEvent=null,this.isDown=!1}return __extends(e,t),e.prototype.GetPressure=function(){return this.isDown===!1||null===this.currentEvent?0:"pen"===this.currentEvent.pointerType?this.currentEvent.pressure:1},e.prototype.InitControlsAvoiding=function(){for(var t=this,e=document.getElementsByClassName("ui-control"),n=0;n<e.length;n++){var r=e[n];r.onpointerover=function(e){return t.isHoveringOverUIControl=!0},r.onpointerout=function(e){return t.isHoveringOverUIControl=!1}}},e.prototype.onPointerMove=function(t){this.onMove(t),this.currentEvent=t},e.prototype.onPointerDown=function(t){this.onDown(t),this.currentEvent=t},e.prototype.onPointerUp=function(t){this.onUp(t),this.currentEvent=t},e.prototype.onPointerLeave=function(t){this.onLeave(t),this.currentEvent=t},e.prototype.onPointerEnter=function(t){0===t.buttons&&(this.isDown=!1),this.currentEvent=t},e.prototype.onPointerOver=function(t){this.isInside=!0,this.currentEvent=t},e}(t.PointingDevice);t.PointerEventsAPI=e}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(t){function e(e,n,r){var i=this;t.call(this,e,n,r),this.board.onmousemove=function(t){return i.onMouseMove(t)},this.board.onmousedown=function(t){return i.onMouseDown(t)},this.board.onmouseup=function(t){return i.onMouseUp(t)},this.board.onmouseleave=function(t){return i.onMouseLeave(t)},this.board.onmouseenter=function(t){return i.onMouseEnter(t)},this.board.onmouseover=function(t){return i.onMouseOver(t)}}return __extends(e,t),e.prototype.InitControlsAvoiding=function(){for(var t=this,e=document.getElementsByClassName("ui-control"),n=0;n<e.length;n++){var r=e[n];r.onmouseover=function(e){return t.isHoveringOverUIControl=!0},r.onmouseout=function(e){return t.isHoveringOverUIControl=!1}}},e.prototype.onMouseMove=function(t){this.onMove(t)},e.prototype.onMouseDown=function(t){this.onDown(t)},e.prototype.onMouseUp=function(t){this.onUp(t)},e.prototype.onMouseLeave=function(t){this.onLeave(t)},e.prototype.onMouseEnter=function(t){0===t.buttons&&(this.isDown=!1)},e.prototype.onMouseOver=function(t){this.isInside=!0},e}(t.PointingDevice);t.Mouse=e}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(t){function e(e,n,r,i){var o=this;t.call(this,e,n,i),this.canvas=r,r.addEventListener("touchstart",function(t){return o.TouchStart(t)}),r.addEventListener("touchend",function(t){return o.TouchEnd(t)}),r.addEventListener("touchcancel",function(t){return o.TouchEnd(t)}),r.addEventListener("touchleave",function(t){return o.TouchLeave(t)}),r.addEventListener("touchmove",function(t){return o.TouchMove(t)})}return __extends(e,t),e.prototype.TouchStart=function(t){t.preventDefault();var e=t.changedTouches,n=e[0];this.currentTouch=n.identifier,this.isInside=!0,this.isHoveringOverUIControl=!1,this.onMouseDown(n)},e.prototype.TouchLeave=function(t){t.preventDefault();var e=this.filterTouch(t.changedTouches);null!==e&&this.onMouseLeave(e)},e.prototype.TouchEnd=function(t){var e=this.filterTouch(t.changedTouches);null!==e&&(this.onMouseUp(e),this.currentTouch=null)},e.prototype.TouchMove=function(t){t.preventDefault();var e=this.filterTouch(t.changedTouches);null!==e&&this.onMouseMove(e)},e.prototype.filterTouch=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.identifier===this.currentTouch)return n}return null},e}(t.Mouse);t.TouchEventsAPI=e}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(){function t(){this.chunks=[]}return Object.defineProperty(t.prototype,"Metadata",{get:function(){return this.metadata},set:function(t){this.metadata=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentChunk",{get:function(){return this.chunks[this.currentChunk]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentChunkNumber",{get:function(){return this.currentChunk},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetCurrentChunkNumber",{set:function(t){this.currentChunk=t},enumerable:!0,configurable:!0}),t.prototype.PeekNextChunk=function(){return this.chunks[this.currentChunk+1]},t.prototype.MoveNextChunk=function(){this.currentChunk++,this.CurrentChunk&&this.CurrentChunk.Rewind()},t.prototype.PushChunk=function(t){return this.currentChunk=this.chunks.push(t)-1,this.currentChunk},t.prototype.Rewind=function(){this.currentChunk=0},t.prototype.RewindMinusOne=function(){this.currentChunk=-1},t.prototype.FastforwardErasedChunksUntil=function(t){var e=this.FindChunk(t,1);return Math.max(this.currentChunk,this.chunks[e].LastErase)},t.prototype.RewindToLastEraseBefore=function(t){var e=this.FindChunk(t,-1);return this.chunks[e].LastErase},t.prototype.FindChunk=function(t,e){for(var n=Math.min(this.currentChunk,this.chunks.length-2);this.chunks[n]&&this.chunks[n+1]&&(this.chunks[n].StartTime<=t&&this.chunks[n+1].StartTime>=t)==!1;)n+=e;return 0>n?0:n},t}();t.Video=e}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n;!function(t){t[t.OutOfProximity=0]="OutOfProximity",t[t.Pen=1]="Pen",t[t.Mouse=2]="Mouse",t[t.Eraseer=3]="Eraseer"}(n||(n={}));var r=function(e){function r(t,n,r,i){e.call(this,t,n,r),this.penApi=i}return __extends(r,e),r.Factory=function(t){return function(e,n,i){return new r(e,n,i,t)}},r.prototype.GetPressure=function(){return this.isDown===!1||this.isInside===!1?0:this.penApi&&this.penApi.pointerType==n.Pen?this.isInside===!0?this.penApi.pressure:0:e.prototype.GetPressure.call(this)},r.IsAvailable=function(){var e=t.Helpers.HTML.CreateElement("object",{type:"application/x-wacomtabletplugin"});return document.body.appendChild(e),!!e.version==!0?(console.log("Wacom tablet is connected and plugin installed. Plugin version is "+e.version+"."),e.penAPI):null},r}(e.Mouse);e.WacomTablet=r}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(t){var e=function(t){function e(e,n,r,i){var o=this;t.call(this,e,n,r,i),this.board.onmousemove=function(t){return o.checkForce(t.webkitForce)},this.forceLevel=0}return __extends(e,t),e.isAvailable=function(){return"WEBKIT_FORCE_AT_FORCE_MOUSE_DOWN"in MouseEvent},e.prototype.GetPressure=function(){return this.forceLevel},e.prototype.checkForce=function(t){this.forceLevel=Math.min(1,t)},e}(t.TouchEventsAPI);t.AppleForceTouch=e}(e=t.VideoData||(t.VideoData={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n;!function(e){var n=t.Helpers.SVG,r=t.Helpers.SVGA,i=t.VideoData.VoidChunk,o=t.VideoData.PathChunk,s=t.VideoData.EraseChunk,a=2,u=function(){function e(t){this.next=t}return e.prototype.FromSVG=function(t,e,n){if(this.next)return this.next.FromSVG(t,e,n);throw new Error("Chunk loading failed: Unsupported node "+e.nodeName+".")},e.prototype.ToSVG=function(t,e){if(this.next)return this.next.ToSVG(t,e);throw new Error("Chunk export failed: Unsupported command "+typeof t+".")},e.prototype.CommandsToSVG=function(t,e,n,r){for(var i=0;i<e.length;i++)t.appendChild(n.ToSVG(e[i],r));return t},e.GetCommands=function(e,n,r){for(var i=this.initCmds.filter(function(t){return null!==t}).map(function(t){return t.Clone()}),o=[];e;){var s=n.FromSVG(e,r);o.push(s),e=e.nextElementSibling,s instanceof t.VideoData.MoveCursor?this.initCmds[0]=s:s instanceof t.VideoData.ChangeBrushColor?this.initCmds[1]=s:s instanceof t.VideoData.ChangeBrushSize&&(this.initCmds[2]=s)}return[i,o]},e.initCmds=[null,null,null],e}();e.ChunkFactory=u;var c=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.FromSVG=function(n,o,s){if(r.attr(o,"type")===e.NodeName){var a=new i(r.numAttr(o,"t"),0);return c=u.GetCommands(o.firstElementChild,s,a.StartTime),a.InitCommands=c[0],a.Commands=c[1],a}return t.prototype.FromSVG.call(this,n,o,s);var c},e.prototype.ToSVG=function(o,s){if(o instanceof i){var u=n.CreateElement("g");return r.SetAttributes(u,{type:e.NodeName,t:o.StartTime.toFixed(a)}),this.CommandsToSVG(u,o.Commands,s,o.StartTime),u}return t.prototype.ToSVG.call(this,o,s)},e.NodeName="void",e}(u);e.VoidChunkFactory=c;var h;!function(t){t[t.Move=0]="Move",t[t.Line=1]="Line",t[t.Curve=2]="Curve",t[t.Arc=3]="Arc",t[t.Close=4]="Close"}(h||(h={}));var l=function(){function e(t,e,n,r){this.letter=t,this.type=e,this.coordsCount=n,this.next=r}return e.prototype.Create=function(t){var e=t.shift();if(e===this.letter){for(var n=[],r=0;r<this.coordsCount;r++)n.push(this.CreateVector2(t.shift()));return{type:this.type,coords:n}}if(this.next)return t.unshift(e),this.next.Create(t);throw new Error("Unsupported instruction letter '"+e+"'")},e.prototype.CreateVector2=function(e){var n=e.split(",");if(2!==n.length)throw new Error("Coordinates pair '"+e+"' is not valid");return new t.Helpers.Vector2(Number(n[0]),Number(n[1]))},e}(),d=function(t){function e(e){t.call(this,"A",h.Arc,3,e)}return __extends(e,t),e.prototype.Create=function(t){var e=t.shift();if(e===this.letter){var n=[];return n.push(this.CreateVector2(t.shift())),t.shift(),n.push(this.CreateVector2(t.shift())),n.push(this.CreateVector2(t.shift())),{type:this.type,coords:n}}if(this.next)return t.unshift(e),this.next.Create(t);throw new Error("Unsupported instruction letter '"+e+"'")},e}(l),p=function(e){function i(t){e.call(this,t),this.next=t,this.instructionFactory=new l("C",h.Curve,3,new l("L",h.Line,1,new l("M",h.Move,1,new d)))}return __extends(i,e),i.prototype.FromSVG=function(t,n,s){if(r.attr(n,"type")===i.NodeName){if(0===n.childElementCount)throw new Error("Path chunk no child elements.");var a=n.firstElementChild;if("path"!==a.localName)throw new Error("Path chunk must begin with a <path> element, but "+a.localName+" found instead");var c=new o(this.SVGNodeToPath(t,a),r.numAttr(n,"t"),0);return h=u.GetCommands(a.nextElementSibling,s,c.StartTime),c.InitCommands=h[0],c.Commands=h[1],c}return e.prototype.FromSVG.call(this,t,n,s);var h},i.prototype.ToSVG=function(t,s){if(t instanceof o){var u=n.CreateElement("g");return r.SetAttributes(u,{type:i.NodeName,t:t.StartTime.toFixed(a)}),u.appendChild(this.PathToSVGNode(t.Path)),this.CommandsToSVG(u,t.Commands,s,t.StartTime),u}return e.prototype.ToSVG.call(this,t,s)},i.prototype.SVGNodeToPath=function(e,r){var i=n.attr(r,"fill"),o=new t.Drawing.Path(e,!0,i),s=n.attr(r,"d");r=null;for(var a=s.split(" ").filter(function(t){return t.length>0}),u=[];a.length>0;)u.push(this.instructionFactory.Create(a));a=null,s=null;var c=u.length-1;if(!(u.length>=2&&u[0].type===h.Move&&u[c].type===h.Arc))throw new Error("Only "+u.length+" valid instructions recognized in a path string");if(o.Segments.push(new t.Drawing.ZeroLengthSegment(u[c-1].coords[0],u[0].coords[0])),u.pop(),u.pop(),u.shift(),1===u.length){var l=o.Segments[0].Right,d=u[0].coords[2];return o.Segments=[new t.Drawing.ZeroLengthSegment(l,d)],o}c=u.length-1;for(var p=o.Segments[0],f=0;f<Math.floor(u.length/2);f++)if(u[f].type===h.Line){var g=new t.Drawing.QuadrilateralSegment(u[f].coords[0],u[c-f].coords[0]);o.Segments.push(g),p instanceof t.Drawing.CurvedSegment&&(p.Left=u[c-f].coords[0].clone()),p=g}else{if(u[f].type!==h.Curve)throw new Error("Unsupported path segment type "+u[f].type+" ");var m=new t.Helpers.BezierCurveSegment(null,u[f].coords[0],u[f].coords[2],u[f].coords[1]),v=new t.Helpers.BezierCurveSegment(u[c-f].coords[2],u[c-f].coords[1],null,u[c-f].coords[0]),C=new t.Drawing.CurvedSegment(v,m);p&&p instanceof t.Drawing.CurvedSegment?(p.Left=C.LeftBezier.Start.clone(),C.RightBezier.Start=p.RightBezier.End.clone()):p&&p instanceof t.Drawing.QuadrilateralSegment&&(C.RightBezier.Start=p.Right.clone()),o.Segments.push(C),p=C}return p&&p instanceof t.Drawing.CurvedSegment&&(p.Left=u[Math.floor(u.length/2)].coords[2].clone()),o},i.prototype.PathToSVGNode=function(e){for(var r=e.Segments,i=r[0],o=i.Right.pointInBetween(i.Left),s=i.Left.clone().subtract(o),a=i.Right.clone().subtract(o),u=n.ArcString(i.Right,o.distanceTo(i.Right),t.Drawing.Path.angle(s)),c="",h=" "+u,l=0;l<r.length;l++){var i=r[l];if(i instanceof t.Drawing.ZeroLengthSegment)c+=n.MoveToString(i.Right)+" ",h=n.MoveToString(i.Left)+" "+h;else if(i instanceof t.Drawing.CurvedSegment)c+=n.CurveToString(i.RightBezier.StartCP,i.RightBezier.EndCP,i.RightBezier.End)+" ",h=n.CurveToString(i.LeftBezier.EndCP,i.LeftBezier.StartCP,i.LeftBezier.Start)+" "+h;else{if(!(i instanceof t.Drawing.QuadrilateralSegment))throw new Error("Unsupported segment type "+typeof i);c+=n.LineToString(i.Right)+" ",h=n.LineToString(i.Left)+" "+h}}i=r[r.length-1],o=i.Right.pointInBetween(i.Left),s=i.Right.clone().subtract(o),a=i.Left.clone().subtract(o);var d=n.ArcString(i.Left,o.distanceTo(i.Left),t.Drawing.Path.angle(s))+" ";return n.CreateElement("path",{fill:e.Color,d:c+d+h})},i.NodeName="path",i}(u);e.PathChunkFactory=p;var f=function(e){function i(){e.apply(this,arguments),this.Width=0,this.Height=0}return __extends(i,e),i.prototype.FromSVG=function(o,a,c){if(r.attr(a,"type")===i.NodeName){if(0===a.childElementCount)throw new Error("Erase chunk no child elements.");var h=a.firstElementChild;if("rect"!==h.localName)throw new Error("Erase chunk must begin with a <rect> element, but "+h.localName+" found instead");var l=new s(new t.UI.Color(n.attr(h,"fill")),r.numAttr(a,"t"),0);return d=u.GetCommands(h.nextElementSibling,c,l.StartTime),l.InitCommands=d[0],l.Commands=d[1],l}return e.prototype.FromSVG.call(this,o,a,c);var d},i.prototype.ToSVG=function(t,o){if(t instanceof s){var u=n.CreateElement("g");return r.SetAttributes(u,{type:i.NodeName,t:t.StartTime.toFixed(a)}),u.appendChild(n.CreateElement("rect",{fill:t.Color.CssValue,width:this.Width,height:this.Height})),this.CommandsToSVG(u,t.Commands,o,t.StartTime),u}return e.prototype.ToSVG.call(this,t,o)},i.NodeName="erase",i}(u);e.EraseChunkFactory=f}(n=e.SVGAnimation||(e.SVGAnimation={}))}(e=t.VideoFormat||(t.VideoFormat={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n;!function(e){var n=t.VideoData.MoveCursor,r=t.VideoData.ChangeBrushColor,i=t.VideoData.ChangeBrushSize,o=t.VideoData.ClearCanvas,s=t.VideoData.DrawNextSegment,a=t.Helpers.SVGA,u=t.Helpers.precise,c=2,h=4,l=function(){function t(t){this.next=t}return t.prototype.FromSVG=function(t,e){if(this.next)return this.next.FromSVG(t,e);throw new Error("Command loading failed: Unsupported node "+t.nodeName+".")},t.prototype.getCmdTime=function(t,e){return a.numAttr(t,"t",0)+e},t.prototype.ToSVG=function(t,e){if(this.next)return this.next.ToSVG(t,e);throw new Error("Command export failed: Unsupported command "+typeof t+".")},t.prototype.storeTime=function(t,e){e>0&&a.SetAttributes(t,{t:u(e,c)})},t}();e.CommandFactory=l;var d=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.FromSVG=function(r,i){return r.localName===e.NodeName?new n(a.numAttr(r,"x"),a.numAttr(r,"y"),a.numAttr(r,"p",0),t.prototype.getCmdTime.call(this,r,i)):t.prototype.FromSVG.call(this,r,i)},e.prototype.ToSVG=function(r,i){if(r instanceof n){var o={x:u(r.X),y:u(r.Y)};r.P>0&&(o.p=u(r.P,h));var s=a.CreateElement(e.NodeName,o);return t.prototype.storeTime.call(this,s,r.Time-i),s}return t.prototype.ToSVG.call(this,r,i)},e.NodeName="m",e}(l);e.MoveCursorFactory=d;var p=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.FromSVG=function(n,r){return n.localName===e.NodeName?new s(t.prototype.getCmdTime.call(this,n,r)):t.prototype.FromSVG.call(this,n,r)},e.prototype.ToSVG=function(n,r){if(n instanceof s){var i=a.CreateElement(e.NodeName);return t.prototype.storeTime.call(this,i,n.Time-r),i}return t.prototype.ToSVG.call(this,n,r)},e.NodeName="d",e}(l);e.DrawSegmentFactory=p;var f=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.FromSVG=function(i,o){return i.localName===n.NodeName?new r(new t.UI.Color(a.attr(i,"c")),e.prototype.getCmdTime.call(this,i,o)):e.prototype.FromSVG.call(this,i,o)},n.prototype.ToSVG=function(t,i){if(t instanceof r){var o=a.CreateElement(n.NodeName,{c:t.Color.CssValue});return e.prototype.storeTime.call(this,o,t.Time-i),o}return e.prototype.ToSVG.call(this,t,i)},n.NodeName="c",n}(l);e.ChangeBrushColorFactory=f;var g=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.FromSVG=function(r,o){return r.localName===n.NodeName?new i(new t.UI.BrushSize(a.numAttr(r,"w")),e.prototype.getCmdTime.call(this,r,o)):e.prototype.FromSVG.call(this,r,o)},n.prototype.ToSVG=function(t,r){if(t instanceof i){var o=a.CreateElement(n.NodeName,{w:t.Size.Size});return e.prototype.storeTime.call(this,o,t.Time-r),o}return e.prototype.ToSVG.call(this,t,r)},n.NodeName="s",n}(l);e.ChangeBrushSizeFactory=g;var m=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.FromSVG=function(r,i){return r.localName===n.NodeName?new o(new t.UI.Color(a.attr(r,"c")),e.prototype.getCmdTime.call(this,r,i)):e.prototype.FromSVG.call(this,r,i)},n.prototype.ToSVG=function(t,r){if(t instanceof o){var i=a.CreateElement(n.NodeName,{c:t.Color.CssValue});return e.prototype.storeTime.call(this,i,t.Time-r),i}return e.prototype.ToSVG.call(this,t,r)},n.NodeName="e",n}(l);e.ClearCanvasFactory=m}(n=e.SVGAnimation||(e.SVGAnimation={}))}(e=t.VideoFormat||(t.VideoFormat={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n;!function(e){var n=t.VideoData.Metadata,r=t.Helpers.SVG,i=t.Helpers.SVGA,o=function(){function e(){}return e.prototype.FromSVG=function(e){var r=new n;if("metadata"!==e.localName)throw new Error("MetadataFactory error parsing SVG: Wrong metadata element "+e.localName);var o=e.firstElementChild;if("length"!==o.localName)throw new Error("MetadataFactory error parsing SVG: Expected 'length', found '"+o.nodeName+"'");r.Length=Number(o.textContent);var s=o.nextElementSibling;if(o=null,"width"!==s.localName)throw new Error("MetadataFactory error parsing SVG: Expected 'length', found '"+s.nodeName+"'");r.Width=Number(s.textContent);var a=s.nextElementSibling;if(s=null,"height"!==a.localName)throw new Error("MetadataFactory error parsing SVG: Expected 'length', found '"+a.nodeName+"'");r.Height=Number(a.textContent),r.AudioTracks=[];for(var u=a.nextElementSibling,c=u.firstElementChild;c;){var h=t.AudioData.AudioSource.StringToType(i.attr(c,"type"));r.AudioTracks.push(new t.AudioData.AudioSource(i.attr(c,"src"),h)),c=c.nextElementSibling}return r},e.prototype.ToSVG=function(t){var e=r.CreateElement("metadata"),n=i.CreateElement("length");n.textContent=t.Length.toFixed(3),e.appendChild(n),n=null;var o=i.CreateElement("width");o.textContent=t.Width.toFixed(0),e.appendChild(o),o=null;var s=i.CreateElement("height");s.textContent=t.Height.toFixed(0),e.appendChild(s),s=null;for(var a=i.CreateElement("audio"),u=0;u<t.AudioTracks.length;u++){var c=t.AudioTracks[u],h=i.CreateElement("source",{type:c.MimeType,src:c.Url});a.appendChild(h),h=null}return e.appendChild(a),e},e}();e.MetadataFactory=o}(n=e.SVGAnimation||(e.SVGAnimation={}))}(e=t.VideoFormat||(t.VideoFormat={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e;!function(e){var n;!function(e){var n=t.VideoData.Video,r=t.Helpers.SVG,i=t.Helpers.SVGA,o=function(){function o(){this.VideoChunksLayerType="video-chunks",this.commandFactory=new e.MoveCursorFactory(new e.DrawSegmentFactory(new e.ChangeBrushColorFactory(new e.ChangeBrushSizeFactory(new e.ClearCanvasFactory)))),this.eraseChunkFactory=new e.EraseChunkFactory,this.chunkFactory=new e.VoidChunkFactory(new e.PathChunkFactory(this.eraseChunkFactory)),this.metadataFactory=new e.MetadataFactory}return o.prototype.SaveVideo=function(t){var e=document.implementation.createDocumentType("svg:svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),n=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",e);n.documentElement.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:a",i.Namespace),r.SetAttributes(n.rootElement,{width:t.Metadata.Width,height:t.Metadata.Height,viewBox:"0 0 "+t.Metadata.Width+" "+t.Metadata.Height}),n.rootElement.appendChild(this.metadataFactory.ToSVG(t.Metadata)),this.eraseChunkFactory.Width=t.Metadata.Width,this.eraseChunkFactory.Height=t.Metadata.Height;var o=r.CreateElement("g");for(i.SetAttributes(o,{type:this.VideoChunksLayerType}),t.Rewind();t.CurrentChunk;)o.appendChild(this.chunkFactory.ToSVG(t.CurrentChunk,this.commandFactory)),t.MoveNextChunk();n.rootElement.appendChild(o);var s=new XMLSerializer;return new Blob([s.serializeToString(n)],{type:"application/svg+xml"})},o.prototype.LoadVideo=function(e,r){if(r instanceof Document==!1)throw new Error("SVGAnimation IO parsing error: Document must be an XML document");var o=r;if(2!==o.documentElement.childElementCount)throw new Error("SVGAnimation document root element must have exactely two children nodes, but has "+o.documentElement.childNodes.length+" instead");var s=new n,a=o.documentElement.firstElementChild;s.Metadata=this.metadataFactory.FromSVG(a);var u=a.nextElementSibling;if("g"!==u.localName||i.attr(u,"type")!==this.VideoChunksLayerType)throw new Error("SVGAnimation IO parsing error: chunks layer must be a SVGÂ <g> node with a:type='"+this.VideoChunksLayerType+"',"+(" got <"+u.localName+"> with a:type='"+i.attr(u,"type")+"'"));for(var c=0,h=0,l=u.firstElementChild;l;){var d=this.chunkFactory.FromSVG(e,l,this.commandFactory);d.LastErase=c,s.PushChunk(d),d instanceof t.VideoData.EraseChunk&&(c=h),l=l.nextElementSibling,h++}return s.Rewind(),s},o.prototype.GetExtension=function(){return"svg"},o.prototype.GetMimeType=function(){return"application/svg+xml"},o}();e.IO=o}(n=e.SVGAnimation||(e.SVGAnimation={}))}(e=t.VideoFormat||(t.VideoFormat={}))}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e=t.AudioData.AudioPlayer,n=t.Helpers.VideoEvents,r=t.Helpers.VideoEventType,i=t.Helpers.Errors,o=t.Helpers.ErrorType,s=function(){function s(e,s){var a=this;this.settings=s,this.lastMouseMoveState=null,this.events=new n;var u=document.getElementById(e);for(u||t.Helpers.Errors.Report(t.Helpers.ErrorType.Fatal,"Container #"+e+" doesn't exist. Video Player couldn't be initialised.");u.firstChild;)u.removeChild(u.firstChild);if(!s.Localization){var c={NoJS:"Your browser does not support JavaScript or it is turned off. Video can't be recorded without enabled JavaScript in your browser.",DataLoadingFailed:"Unfortunatelly, downloading data failed.",DataIsCorrupted:"This video can't be played, the data is corrupted.",ControlPlayback:"Play/Pause video",Play:"Play",Pause:"Pause",Replay:"Replay",TimeStatus:"Video progress",VolumeControl:"Volume controls",VolumeUp:"Volume up",VolumeDown:"Volume down",Mute:"Mute",Busy:"Loading..."};s.Localization=c}this.timer=new t.Helpers.VideoTimer(!1),this.ui=s.UI?s.UI:new t.UI.PlayerUI(e,this.events),this.ui.Timer=this.timer,this.ui.Localization=s.Localization,s.ShowControls&&this.ui.CreateControls(!!s.Autohide),this.drawer=s.DrawingStrategy?s.DrawingStrategy:new t.Drawing.CanvasDrawer(!0),this.drawer.SetEvents(this.events),this.ui.AcceptCanvas(this.drawer.CreateCanvas()),u.appendChild(this.ui.GetHTML()),this.events.on(r.Start,function(){return a.Play()}),this.events.on(r.Pause,function(){return a.Pause()}),this.events.on(r.ReachEnd,function(){return a.Pause()}),this.events.on(r.ClearCanvas,function(t){return a.ClearCavnas(t)}),this.events.on(r.ChangeColor,function(t){return a.drawer.SetCurrentColor(t)}),this.events.on(r.JumpTo,function(t){return a.JumpTo(t)}),this.events.on(r.DrawSegment,function(){return a.DrawSegment()}),this.events.on(r.DrawPath,function(t){a.drawnPath.DrawWholePath(),a.drawnPath=null}),this.busyLevel=0,this.events.on(r.Busy,function(){return a.Busy()}),this.events.on(r.Ready,function(){return a.Ready()}),this.ui.SetBusyText(s.Localization.Busy),this.events.trigger(r.Busy),t.Helpers.File.ReadFileAsync(s.Source,function(t){a.ProcessVideoData(t),a.MonitorResize(u),window.onresize=function(){return a.MonitorResize(u)}},function(t){i.Report(o.Warning,a.settings.Localization.DataLoadingFailed),a.ui.SetBusyText(s.Localization.DataLoadingFailed)})}return Object.defineProperty(s.prototype,"Events",{get:function(){return this.events},enumerable:!0,configurable:!0}),s.prototype.MonitorResize=function(t){var e=t.getBoundingClientRect();if(e.width!==this.oldWidth||e.height!==this.oldHeight){this.drawer.Stretch();var n=this.drawer.SetupOutputCorrection(this.video.Metadata.Width,this.video.Metadata.Height);this.events.trigger(r.CanvasScalingFactor,n),this.video&&this.RedrawCurrentScreen(),this.oldWidth=e.width,this.oldHeight=e.height}},s.prototype.ProcessVideoData=function(n){try{var i=this.settings.VideoFormat?this.settings.VideoFormat:new t.VideoFormat.SVGAnimation.IO;this.video=i.LoadVideo(this.events,n),i=null,this.audio=new e(this.events,this.video.Metadata.AudioTracks)}catch(o){return i=null,this.video=null,this.audio=null,void this.ui.SetBusyText(this.settings.Localization.DataIsCorrupted)}this.events.trigger(r.VideoInfoLoaded,this.video.Metadata),this.video.RewindMinusOne(),this.MoveToNextChunk(),this.events.trigger(r.Ready),this.settings.Autoplay&&this.events.trigger(r.Start)},s.prototype.Play=function(){var t=this;this.isPlaying=!0,this.timer.Resume(),!!this.audio&&this.audio.Play(),this.ticking=requestAnimationFrame(function(){return t.Tick()})},s.prototype.Pause=function(){this.timer.Pause(),this.isPlaying=!1,!!this.audio&&this.audio.Pause(),cancelAnimationFrame(this.ticking)},s.prototype.Tick=function(){var t=this;this.Sync(),this.ticking=requestAnimationFrame(function(){return t.Tick()})},s.prototype.Sync=function(){for(;this.video.CurrentChunk;){if(void 0===this.video.CurrentChunk.CurrentCommand&&(this.MoveToNextChunk(),!this.video.CurrentChunk||!this.video.CurrentChunk.CurrentCommand)){this.timer.CurrentTime()>=this.video.Metadata.Length&&this.ReachedEnd();break}if(this.video.CurrentChunk.CurrentCommand.Time>this.timer.CurrentTime())break;this.video.CurrentChunk.CurrentCommand instanceof t.VideoData.MoveCursor?this.lastMouseMoveState=this.video.CurrentChunk.CurrentCommand:this.video.CurrentChunk.CurrentCommand.Execute(this.events),this.video.CurrentChunk.MoveNextCommand()}null!==this.lastMouseMoveState&&(this.lastMouseMoveState.Execute(this.events),this.lastMouseMoveState=null),null!==this.drawnPath&&this.drawnPath.Draw()},s.prototype.MoveToNextChunk=function(){for(;;){if(this.video.MoveNextChunk(),!this.video.CurrentChunk){this.ReachedEnd();break}if(this.video.CurrentChunk.ExecuteInitCommands(this.events),this.video.CurrentChunk instanceof t.VideoData.PathChunk){this.drawnPath=this.drawer.CreatePath(this.events);var e=this.video.CurrentChunk.Path;this.drawnPath.Segments=e.Segments,this.drawnPath.Color=e.Color,this.drawnSegment=0,e=this.drawnPath}else this.drawnPath=null;if(!(this.video.PeekNextChunk()&&this.video.PeekNextChunk().StartTime<=this.timer.CurrentTime()))break;this.video.CurrentChunk.Render(this.events)}},s.prototype.JumpTo=function(t){var e=this.isPlaying,n=t*this.video.Metadata.Length,i=this.timer.CurrentTime();this.timer.SetTime(n),this.audio.JumpTo(t),this.isPlaying&&this.events.trigger(r.Pause);var o=0;o=n>=i?this.video.FastforwardErasedChunksUntil(n):this.video.RewindToLastEraseBefore(n),o!==this.video.CurrentChunkNumber&&(this.video.SetCurrentChunkNumber=o-1,this.MoveToNextChunk()),this.Sync(),this.ui.UpdateCurrentTime(),e===!0&&this.events.trigger(r.Start)},s.prototype.RedrawCurrentScreen=function(){var t=this.isPlaying;this.isPlaying&&this.events.trigger(r.Pause);var e=0;e=this.video.RewindToLastEraseBefore(this.timer.CurrentTime()),this.video.SetCurrentChunkNumber=e-1,this.MoveToNextChunk(),this.Sync(),t===!0&&this.events.trigger(r.Start)},s.prototype.ReachedEnd=function(){this.events.trigger(r.ReachEnd)},s.prototype.ClearCavnas=function(t){this.drawer.ClearCanvas(t)},s.prototype.DrawSegment=function(){0===this.drawnSegment?(this.drawnPath.StartDrawingPath(this.drawnPath.Segments[0]),this.drawnSegment++):this.drawnPath.DrawSegment(this.drawnPath.Segments[this.drawnSegment++]);
},s.prototype.Busy=function(){this.busyLevel++,this.wasPlayingWhenBusy=this.wasPlayingWhenBusy||this.isPlaying,this.events.trigger(r.Pause),this.ui.Busy()},s.prototype.Ready=function(){0===--this.busyLevel&&(this.wasPlayingWhenBusy===!0&&(this.events.trigger(r.Start),this.wasPlayingWhenBusy=!1),this.ui.Ready())},s}();t.Player=s}(VectorScreencast||(VectorScreencast={}));var VectorScreencast;!function(t){var e=t.VideoData.Video,n=t.Drawing.SVGDrawer,r=t.AudioData.AudioRecorder,i=t.Helpers.Errors,o=t.Helpers.ErrorType,s=t.Helpers.VideoEvents,a=t.Helpers.VideoEventType,u=t.VideoData.Metadata,c=function(){function c(u,c){var h=this;this.id=u,this.settings=c,this.events=new s,this.isRecording=!1,this.timer=new t.Helpers.VideoTimer(!1),this.recordingBlocked=!1,this.data=new e,this.lastEraseData=0,this.recordAllRawData=void 0!==c.RecordAllRawData?!!c.RecordAllRawData:!0,c.DefaultBackgroundColor&&(t.UI.Color.BackgroundColor=c.DefaultBackgroundColor),c.DefaultBrushColor&&(t.UI.Color.ForegroundColor=c.DefaultBrushColor);var l=document.getElementById(u);if(!l)return void i.Report(o.Fatal,"Container #"+u+" doesn't exist. Video Recorder couldn't be initialised.");for(;l.firstChild;)l.removeChild(l.firstChild);if(!c.ColorPallete||0===c.ColorPallete.length){var d=[];d.push(new t.UI.Color("#ffffff")),d.push(new t.UI.Color("#fa5959")),d.push(new t.UI.Color("#8cfa59")),d.push(new t.UI.Color("#59a0fa")),d.push(new t.UI.Color("#fbff06")),d.push(t.UI.Color.BackgroundColor),c.ColorPallete=d}if(d.indexOf(t.UI.Color.BackgroundColor)||d.push(t.UI.Color.BackgroundColor),!c.BrushSizes||0===c.BrushSizes.length){var p=[];p.push(new t.UI.BrushSize(2)),p.push(new t.UI.BrushSize(3)),p.push(new t.UI.BrushSize(4)),p.push(new t.UI.BrushSize(6)),p.push(new t.UI.BrushSize(8)),p.push(new t.UI.BrushSize(10)),p.push(new t.UI.BrushSize(15)),p.push(new t.UI.BrushSize(80)),c.BrushSizes=p}if(!c.Localization){var f={NoJS:"Your browser does not support JavaScript or it is turned off. Video can't be recorded without enabled JavaScript in your browser.",Busy:"Preparing recording studio...",RecPause:"Control recording",Record:"Start",Pause:"Pause recording",Upload:"Upload",UploadInProgress:"Uploading data...",ChangeColor:"Change brush color",ChangeSize:"Change brush size",Erase:"Eraser",EraseAll:"Erase everything",WaitingText:"Please be patient. Uploading video usually takes some times - up to a few minutes if your video is over ten minutes long. Do not close this tab or browser window.",UploadWasSuccessful:"Upload was successful",RedirectPrompt:"Upload was successful - press OK to continue",UploadFailure:"Upload failed.",FailureApology:"We are sorry, but upload failed. Do you want to download your data to your computer instead?",AudioRecording:"Audio recording",AudioRecordingAvailable:"Audio recording is available",AudioRecordingUnavailable:"Audio recording is unavailable"};c.Localization=f}this.events.on(a.ChangeBrushSize,function(t){return h.ChangeBrushSize(t)}),this.events.on(a.ChangeColor,function(t){return h.ChangeColor(t)}),this.events.on(a.CursorState,function(t){return h.ProcessCursorState(t)}),this.events.on(a.ClearCanvas,function(t){return h.ClearCanvas(t)}),this.events.on(a.Start,function(){return h.Start()}),this.events.on(a.Pause,function(){return h.Pause()}),this.events.on(a.StartUpload,function(){return h.StartUpload()}),this.busyLevel=0,this.events.on(a.Busy,function(){return h.Busy()}),this.events.on(a.Ready,function(){return h.Ready()}),this.events.on(a.StartPath,function(e){h.PushChunk(new t.VideoData.PathChunk(e,h.timer.CurrentTime(),h.lastEraseData)),h.data.CurrentChunk.PushCommand(new t.VideoData.DrawNextSegment(h.timer.CurrentTime()))}),this.events.on(a.DrawSegment,function(){return h.data.CurrentChunk.PushCommand(new t.VideoData.DrawNextSegment(h.timer.CurrentTime()))});var g=p.reduce(function(t,e,n,r){return t.Size<e.Size?t:e}).Size,m=p.reduce(function(t,e,n,r){return t.Size>e.Size?t:e}).Size;this.drawer=c.DrawingStrategy?c.DrawingStrategy:new n(!0),this.drawer.SetEvents(this.events),this.dynaDraw=new t.Drawing.DynaDraw(this.events,function(){return h.drawer.CreatePath(h.events)},!c.DisableDynamicLineWidth,g,m,this.timer),this.ui=c.UI?c.UI:new t.UI.RecorderUI(u,this.events),this.ui.Timer=this.timer,this.ui.Localization=c.Localization,this.ui.SetBusyText(c.Localization.Busy),this.ui.CreateHTML(!!c.Autohide,c.ColorPallete,c.BrushSizes);var v=this.drawer.CreateCanvas();this.ui.AcceptCanvas(v),l.appendChild(this.ui.GetHTML()),this.drawer.Stretch(),this.pointer=t.VideoData.PointingDevice.SelectBestMethod(this.events,this.ui.GetHTML(),v,this.timer),c.Audio&&(this.audioRecorder=new r(c.Audio,this.events),this.audioRecorder.Init()),this.ClearCanvas(t.UI.Color.BackgroundColor),this.events.trigger(a.ChangeColor,t.UI.Color.ForegroundColor),this.events.trigger(a.ChangeBrushSize,new t.UI.BrushSize(5))}return Object.defineProperty(c.prototype,"Events",{get:function(){return this.events},enumerable:!0,configurable:!0}),c.prototype.Start=function(){this.isRecording===!1&&(this.isRecording=!0,this.PushChunk(new t.VideoData.VoidChunk(this.timer.CurrentTime(),this.lastEraseData)),this.timer.Resume(),this.audioRecorder&&this.audioRecorder.Start())},c.prototype.Pause=function(){this.isRecording===!0&&(this.isRecording=!1,this.PushChunk(new t.VideoData.VoidChunk(this.timer.CurrentTime(),this.lastEraseData)),this.timer.Pause(),this.audioRecorder&&this.audioRecorder.Pause())},c.prototype.StartUpload=function(){var t=this;this.recordingBlocked=!0;var e=new u;e.Length=this.timer.CurrentTime(),e.Width=this.ui.Width,e.Height=this.ui.Height,e.AudioTracks=[],this.data.Metadata=e,this.audioRecorder&&this.audioRecorder.isRecording()?this.audioRecorder.Stop(function(e){t.data.Metadata.AudioTracks=e,t.UploadData()},function(){t.FinishRecording(!1)}):this.UploadData()},c.prototype.ChangeBrushSize=function(e){!this.recordingBlocked&&this.data.CurrentChunk.PushCommand(new t.VideoData.ChangeBrushSize(e,this.timer.CurrentTime())),this.dynaDraw.SetBrushSize(e)},c.prototype.ChangeColor=function(e){!this.recordingBlocked&&this.data.CurrentChunk.PushCommand(new t.VideoData.ChangeBrushColor(e,this.timer.CurrentTime())),this.drawer.SetCurrentColor(e)},c.prototype.ProcessCursorState=function(e){!this.recordingBlocked&&(this.recordAllRawData||this.isRecording)&&this.data.CurrentChunk.PushCommand(new t.VideoData.MoveCursor(e.X,e.Y,this.recordAllRawData?e.Pressure:0,this.timer.CurrentTime())),this.dynaDraw.ObserveCursorMovement(e)},c.prototype.ClearCanvas=function(e){var n=this.timer.CurrentTime();this.lastEraseData=this.PushChunk(new t.VideoData.EraseChunk(e,n,this.lastEraseData)),this.data.CurrentChunk.PushCommand(new t.VideoData.ClearCanvas(e,n)),this.drawer.ClearCanvas(e)},c.prototype.PushChunk=function(t){return this.data.PushChunk(t)},c.prototype.Busy=function(){this.busyLevel++,this.wasRecordingWhenBusy=this.wasRecordingWhenBusy||this.isRecording,this.events.trigger(a.Pause),this.ui.Busy()},c.prototype.Ready=function(){0===--this.busyLevel&&(this.wasRecordingWhenBusy===!0&&(this.events.trigger(a.Start),this.wasRecordingWhenBusy=!1),this.ui.Ready())},c.prototype.UploadData=function(){var e=this,n=this.settings.VideoFormat?this.settings.VideoFormat:new t.VideoFormat.SVGAnimation.IO,r=n.SaveVideo(this.data);console.log(r),this.events.on(a.DownloadData,function(){t.Helpers.File.Download(r,"recorded-animation."+n.GetExtension())}),this.ui.SetBusyText(this.settings.Localization.UploadInProgress),this.events.trigger(a.Busy);var i=new FormData;i.append("extension",n.GetExtension()),i.append("file",r);var o=new XMLHttpRequest;o.open("POST",this.settings.UploadURL,!0),o.onerror=function(t){return e.FinishRecording(!1)},o.onload=function(t){var n=JSON.parse(o.response);if(200===o.status&&n.hasOwnProperty("success")&&n.success===!0){var r=n.hasOwnProperty("redirect")?n.redirect:!1;e.FinishRecording(!0,r)}else e.FinishRecording(!1)},o.send(i)},c.prototype.FinishRecording=function(t,e){t===!0?(this.ui.SetBusyText(this.settings.Localization.UploadWasSuccessful),"string"==typeof e?confirm(this.settings.Localization.RedirectPrompt)&&window.location.replace(e):alert(this.settings.Localization.UploadWasSuccessful)):(this.ui.SetBusyText(this.settings.Localization.UploadFailure),confirm(this.settings.Localization.FailureApology)&&this.events.trigger(a.DownloadData))},c}();t.Recorder=c}(VectorScreencast||(VectorScreencast={}));