webpackJsonp([2],{0:function(t,e,n){"use strict";var i=n(11),r=n(1),o=n(8),s=n(32),a=n(18),u=n(27),h=n(10),c=n(9),l=n(15),d=n(25),p=function(){function t(t,e){var n=this;this.settings=e,this.lastMouseMoveState=null,this.events=new r["default"];var i=document.getElementById(t);for(i||o["default"].Report(o.ErrorType.Fatal,"Container #"+t+" doesn't exist. Video Player couldn't be initialised.");i.firstChild;)i.removeChild(i.firstChild);if(!e.Localization){var h={NoJS:"Your browser does not support JavaScript or it is turned off. Video can't be recorded without enabled JavaScript in your browser.",DataLoadingFailed:"Unfortunatelly, downloading data failed.",DataIsCorrupted:"This video can't be played, the data is corrupted.",ControlPlayback:"Play/Pause video",Play:"Play",Pause:"Pause",Replay:"Replay",TimeStatus:"Video progress",VolumeControl:"Volume controls",VolumeUp:"Volume up",VolumeDown:"Volume down",Mute:"Mute",Busy:"Loading..."};e.Localization=h}this.timer=new a["default"](!1),this.ui=e.UI?e.UI:new s["default"](t,this.events),this.ui.Timer=this.timer,this.ui.Localization=e.Localization,e.ShowControls&&this.ui.CreateControls(!!e.Autohide),this.drawer=e.DrawingStrategy?e.DrawingStrategy:new u["default"](!0),this.drawer.SetEvents(this.events),this.ui.AcceptCanvas(this.drawer.CreateCanvas()),i.appendChild(this.ui.GetHTML()),this.events.on(r.VideoEventType.Start,function(){return n.Play()}),this.events.on(r.VideoEventType.Pause,function(){return n.Pause()}),this.events.on(r.VideoEventType.ReachEnd,function(){return n.Pause()}),this.events.on(r.VideoEventType.ClearCanvas,function(t){return n.ClearCavnas(t)}),this.events.on(r.VideoEventType.ChangeColor,function(t){return n.drawer.SetCurrentColor(t)}),this.events.on(r.VideoEventType.JumpTo,function(t){return n.JumpTo(t)}),this.events.on(r.VideoEventType.DrawSegment,function(){return n.DrawSegment()}),this.events.on(r.VideoEventType.DrawPath,function(t){n.drawnPath.DrawWholePath(),n.drawnPath=null}),this.busyLevel=0,this.events.on(r.VideoEventType.Busy,function(){return n.Busy()}),this.events.on(r.VideoEventType.Ready,function(){return n.Ready()}),this.ui.SetBusyText(e.Localization.Busy),this.events.trigger(r.VideoEventType.Busy),l["default"].ReadFileAsync(e.Source,function(t){n.ProcessVideoData(t),n.MonitorResize(i),window.onresize=function(){return n.MonitorResize(i)}},function(t){o["default"].Report(o.ErrorType.Warning,n.settings.Localization.DataLoadingFailed),n.ui.SetBusyText(e.Localization.DataLoadingFailed)})}return Object.defineProperty(t.prototype,"Events",{get:function(){return this.events},enumerable:!0,configurable:!0}),t.prototype.MonitorResize=function(t){var e=t.getBoundingClientRect();if(e.width!==this.oldWidth||e.height!==this.oldHeight){this.drawer.Stretch();var n=this.drawer.SetupOutputCorrection(this.video.Metadata.Width,this.video.Metadata.Height);this.events.trigger(r.VideoEventType.CanvasScalingFactor,n),this.video&&this.RedrawCurrentScreen(),this.oldWidth=e.width,this.oldHeight=e.height}},t.prototype.ProcessVideoData=function(t){try{var e=this.settings.VideoFormat?this.settings.VideoFormat:new d["default"];this.video=e.LoadVideo(this.events,t),e=null,this.audio=new i["default"](this.events,this.video.Metadata.AudioTracks)}catch(n){return e=null,this.video=null,this.audio=null,void this.ui.SetBusyText(this.settings.Localization.DataIsCorrupted)}this.events.trigger(r.VideoEventType.VideoInfoLoaded,this.video.Metadata),this.video.RewindMinusOne(),this.MoveToNextChunk(),this.events.trigger(r.VideoEventType.Ready),this.settings.Autoplay&&this.events.trigger(r.VideoEventType.Start)},t.prototype.Play=function(){var t=this;this.isPlaying=!0,this.timer.Resume(),!!this.audio&&this.audio.Play(),this.ticking=requestAnimationFrame(function(){return t.Tick()})},t.prototype.Pause=function(){this.timer.Pause(),this.isPlaying=!1,!!this.audio&&this.audio.Pause(),cancelAnimationFrame(this.ticking)},t.prototype.Tick=function(){var t=this;this.Sync(),this.ticking=requestAnimationFrame(function(){return t.Tick()})},t.prototype.Sync=function(){for(;this.video.CurrentChunk;){if(void 0===this.video.CurrentChunk.CurrentCommand&&(this.MoveToNextChunk(),!this.video.CurrentChunk||!this.video.CurrentChunk.CurrentCommand)){this.timer.CurrentTime()>=this.video.Metadata.Length&&this.ReachedEnd();break}if(this.video.CurrentChunk.CurrentCommand.Time>this.timer.CurrentTime())break;this.video.CurrentChunk.CurrentCommand instanceof h.MoveCursor?this.lastMouseMoveState=this.video.CurrentChunk.CurrentCommand:this.video.CurrentChunk.CurrentCommand.Execute(this.events),this.video.CurrentChunk.MoveNextCommand()}null!==this.lastMouseMoveState&&(this.lastMouseMoveState.Execute(this.events),this.lastMouseMoveState=null),null!==this.drawnPath&&this.drawnPath.Draw()},t.prototype.MoveToNextChunk=function(){for(;;){if(this.video.MoveNextChunk(),!this.video.CurrentChunk){this.ReachedEnd();break}if(this.video.CurrentChunk.ExecuteInitCommands(this.events),this.video.CurrentChunk instanceof c.PathChunk){this.drawnPath=this.drawer.CreatePath(this.events);var t=this.video.CurrentChunk.Path;this.drawnPath.Segments=t.Segments,this.drawnPath.Color=t.Color,this.drawnSegment=0,t=this.drawnPath}else this.drawnPath=null;if(!(this.video.PeekNextChunk()&&this.video.PeekNextChunk().StartTime<=this.timer.CurrentTime()))break;this.video.CurrentChunk.Render(this.events)}},t.prototype.JumpTo=function(t){var e=this.isPlaying,n=t*this.video.Metadata.Length,i=this.timer.CurrentTime();this.timer.SetTime(n),this.audio.JumpTo(t),this.isPlaying&&this.events.trigger(r.VideoEventType.Pause);var o=0;o=n>=i?this.video.FastforwardErasedChunksUntil(n):this.video.RewindToLastEraseBefore(n),o!==this.video.CurrentChunkNumber&&(this.video.SetCurrentChunkNumber=o-1,this.MoveToNextChunk()),this.Sync(),this.ui.UpdateCurrentTime(),e===!0&&this.events.trigger(r.VideoEventType.Start)},t.prototype.RedrawCurrentScreen=function(){var t=this.isPlaying;this.isPlaying&&this.events.trigger(r.VideoEventType.Pause);var e=0;e=this.video.RewindToLastEraseBefore(this.timer.CurrentTime()),this.video.SetCurrentChunkNumber=e-1,this.MoveToNextChunk(),this.Sync(),t===!0&&this.events.trigger(r.VideoEventType.Start)},t.prototype.ReachedEnd=function(){this.events.trigger(r.VideoEventType.ReachEnd)},t.prototype.ClearCavnas=function(t){this.drawer.ClearCanvas(t)},t.prototype.DrawSegment=function(){0===this.drawnSegment?(this.drawnPath.StartDrawingPath(this.drawnPath.Segments[0]),this.drawnSegment++):this.drawnPath.DrawSegment(this.drawnPath.Segments[this.drawnSegment++])},t.prototype.Busy=function(){this.busyLevel++,this.wasPlayingWhenBusy=this.wasPlayingWhenBusy||this.isPlaying,this.events.trigger(r.VideoEventType.Pause),this.ui.Busy()},t.prototype.Ready=function(){0===--this.busyLevel&&(this.wasPlayingWhenBusy===!0&&(this.events.trigger(r.VideoEventType.Start),this.wasPlayingWhenBusy=!1),this.ui.Ready())},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=p},27:function(t,e,n){"use strict";var i=n(1),r=n(2),o=n(12),s=function(){function t(t){void 0===t&&(t=!0),this.curved=t}return t.prototype.SetEvents=function(t){this.events=t},t.prototype.CreateCanvas=function(){return this.canvas=r["default"].CreateElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas},t.prototype.Stretch=function(){var t=this.canvas.parentElement,e=t.clientWidth,n=t.clientHeight;this.originalHeight=n,this.originalWidth=e,r["default"].SetAttributes(this.canvas,{width:e,height:n}),this.events.trigger(i.VideoEventType.CanvasSize,e,n)},t.prototype.SetupOutputCorrection=function(t,e){var n=this.canvas.width/t,i=this.canvas.height/e,r=Math.min(n,i);return this.context.scale(r,r),r},t.prototype.ClearCanvas=function(t){this.context.fillStyle=t.CssValue,this.context.fillRect(0,0,this.originalWidth,this.originalHeight)},t.prototype.SetCurrentColor=function(t){this.currentColor=t},t.prototype.CreatePath=function(t){return new o.CanvasPath(t,this.curved,this.currentColor.CssValue,this.context)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=s},32:function(t,e,n){"use strict";var i=function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(1),o=n(2),s=n(6),a=n(5),u=n(19),h=n(34),c=function(t){function e(e,n){var i=this;t.call(this,"div",e+"-player"),this.id=e,this.events=n,this.isBusy=!1,this.tickingInterval=200,this.isMuted=!1,this.AddClass("vector-video-wrapper"),this.board=this.CreateBoard(),this.AddChild(this.board),this.events.on(r.VideoEventType.Start,function(){return i.StartPlaying()}),this.events.on(r.VideoEventType.Pause,function(){return i.PausePlaying()}),this.events.on(r.VideoEventType.ReachEnd,function(){return i.ReachedEnd()}),this.events.on(r.VideoEventType.JumpTo,function(){return i.JumpTo()}),this.events.on(r.VideoEventType.ClearCanvas,function(t){return i.GetHTML().style.backgroundColor=t.CssValue}),this.isPlaying=!1,this.reachedEnd=!1}return i(e,t),e.prototype.CreateControls=function(t){var e=this;this.timeline=this.CreateTimeLine(),this.hidingButton=new a.IconOnlyButton(t?"icon-show":"icon-hide","",function(t){return e.ToggleAutohiding()}).AddClasses("autohiding-toggle"),this.controls=new a.Panel("div",this.id+"-controls").AddClasses("ui-controls","ui-control").AddChildren(this.CreateButtonsPanel(),this.timeline,this.CreateTimeStatus(),this.CreateAudioControls()),!!t&&this.controls.AddClass("autohide"),this.AddChildren(new a.Panel("div").AddClass("ui-controls-wrapper").AddChildren(this.controls,this.hidingButton)),this.events.on(r.VideoEventType.VideoInfoLoaded,function(t){e.videoDuration=t.Length,e.totalTime.GetHTML().textContent=s.millisecondsToString(t.Length),e.timeline.Length=t.Length}),this.events.on(r.VideoEventType.BufferStatus,function(t){return e.timeline.SetBuffer(1e3*t)}),this.BindKeyboardShortcuts()},e.prototype.SetBusyText=function(t){o["default"].SetAttributes(this.GetHTML(),{"data-busy-string":t})},e.prototype.BindKeyboardShortcuts=function(){var t=this,e=32,n=37,i=39,r=5e3;window.onkeyup=function(o){switch(o.keyCode){case e:t.PlayPause();break;case n:t.timeline.SkipTo(Math.max(0,t.Timer.CurrentTime()-r));break;case i:t.timeline.SkipTo(Math.min(t.Timer.CurrentTime()+r,t.videoDuration))}}},e.prototype.AcceptCanvas=function(t){this.board.GetHTML().appendChild(t)},e.prototype.CreateBoard=function(){var t=this,e=new u["default"](this.id+"-board",this.events);return e.GetHTML().onclick=function(){return t.PlayPause()},e},e.prototype.CreateButtonsPanel=function(){var t=this;return this.playPauseButton=new a.IconOnlyButton("icon-play",this.Localization.Play,function(e){return t.PlayPause()}),new a.Panel("div").AddChildren(new a.H2(this.Localization.ControlPlayback),this.playPauseButton).AddClass("ui-controls-panel")},e.prototype.PlayPause=function(){return!this.isBusy&&this.controls?this.reachedEnd?(this.reachedEnd=!1,this.timeline.SkipTo(0),void this.events.trigger(r.VideoEventType.Start)):void(this.isPlaying===!0?(this.PausePlaying(),this.events.trigger(r.VideoEventType.Pause)):(this.StartPlaying(),this.events.trigger(r.VideoEventType.Start))):void 0},e.prototype.JumpTo=function(){this.controls&&this.reachedEnd===!0&&(this.reachedEnd=!1,this.playPauseButton.ChangeIcon("icon-play"))},e.prototype.StartPlaying=function(){var t=this;this.controls&&this.isPlaying===!1&&(this.isPlaying=!0,this.playPauseButton.ChangeIcon("icon-pause"),this.playPauseButton.ChangeContent(this.Localization.Pause),this.AddClass("playing"),this.ticking=setInterval(function(){return t.UpdateCurrentTime()},this.tickingInterval))},e.prototype.PausePlaying=function(){this.controls&&(this.isPlaying=!1,this.playPauseButton.ChangeIcon("icon-play"),this.playPauseButton.ChangeContent(this.Localization.Play),this.RemoveClass("playing"),clearInterval(this.ticking))},e.prototype.CreateTimeLine=function(){return new h["default"](this.id+"-timeline",this.events)},e.prototype.CreateTimeStatus=function(){return this.currentTime=new a.SimpleElement("span","0:00"),this.totalTime=new a.SimpleElement("span","0:00"),new a.Panel("div").AddChildren(new a.H2(this.Localization.TimeStatus),new a.Panel("div").AddChildren(this.currentTime,new a.SimpleElement("span"," / "),this.totalTime).AddClass("ui-time")).AddClass("ui-controls-panel")},e.prototype.UpdateCurrentTime=function(t){this.currentTime.GetHTML().textContent=s.millisecondsToString(t?t:this.Timer.CurrentTime()),this.timeline.Sync(t?t:this.Timer.CurrentTime())},e.prototype.ReachedEnd=function(){this.controls&&(this.PausePlaying(),this.playPauseButton.ChangeIcon("icon-replay").ChangeContent(this.Localization.Replay),this.reachedEnd=!0,this.UpdateCurrentTime())},e.prototype.Busy=function(){this.AddClass("busy"),this.isBusy=!0},e.prototype.Ready=function(){this.RemoveClass("busy"),this.isBusy=!1},e.prototype.CreateAudioControls=function(){var t=this;return new a.Panel("div",this.id+"-audio").AddChildren(new a.H2(this.Localization.VolumeControl),new a.Panel("div",this.id+"-audio-controls").AddChildren(this.volumeDownBtn=new a.IconOnlyButton("icon-volume-down",this.Localization.VolumeDown,function(e){return t.VolumeDown()}),this.volumeUpBtn=new a.IconOnlyButton("icon-volume-up",this.Localization.VolumeUp,function(e){return t.VolumeUp()}),this.volumeOffBtn=new a.IconOnlyButton("icon-volume-off",this.Localization.Mute,function(e){return t.Mute()})).AddClass("btn-group")).AddClasses("ui-controls-panel","vector-video-audio-controls")},e.prototype.VolumeUp=function(){this.events.trigger(r.VideoEventType.VolumeUp)},e.prototype.VolumeDown=function(){this.events.trigger(r.VideoEventType.VolumeDown)},e.prototype.Mute=function(){this.isMuted?(this.volumeDownBtn.GetHTML().removeAttribute("disabled"),this.volumeUpBtn.GetHTML().removeAttribute("disabled"),this.volumeOffBtn.RemoveClass("active")):(o["default"].SetAttributes(this.volumeDownBtn.GetHTML(),{disabled:"disabled"}),o["default"].SetAttributes(this.volumeUpBtn.GetHTML(),{disabled:"disabled"}),this.volumeOffBtn.AddClass("active")),this.isMuted=!this.isMuted,this.events.trigger(r.VideoEventType.Mute)},e.prototype.ToggleAutohiding=function(){this.controls.HasClass("autohide")?(this.controls.RemoveClass("autohide"),this.hidingButton.ChangeIcon("icon-hide")):(this.controls.AddClass("autohide"),this.hidingButton.ChangeIcon("icon-show"))},e}(a.Panel);Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=c},34:function(t,e,n){"use strict";var i=function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(1),o=n(5),s=n(6),a=function(t){function e(e,n){var i=this;t.call(this,"div",e),this.events=n,this.length=0,this.GetHTML().classList.add("ui-progressbar");var r=new o.Panel("div");r.AddClass("ui-progress"),r.AddChild(new o.SimpleElement("div").AddClass("ui-current-time")),this.progresbar=r,this.AddChild(r),r=null;var s=new o.SimpleElement("div");s.AddClass("ui-buffer"),this.bufferbar=s,this.AddChild(s),s=null,this.arrow=new o.SimpleElement("div","0:00"),this.arrow.AddClass("ui-arrow"),this.AddChild(this.arrow),this.Sync(0),this.GetHTML().onclick=function(t){return i.OnClick(t)},this.GetHTML().onmousemove=function(t){return i.OnMouseMove(t)}}return i(e,t),Object.defineProperty(e.prototype,"Length",{set:function(t){this.length=t},enumerable:!0,configurable:!0}),e.prototype.OnClick=function(t){var e=(t.clientX-this.GetHTML().clientLeft)/this.GetHTML().clientWidth*this.length;this.SkipTo(e)},e.prototype.OnMouseMove=function(t){var e=(t.clientX-this.GetHTML().clientLeft)/this.GetHTML().clientWidth,n=s.millisecondsToString(e*this.length);this.arrow.GetHTML().textContent=n,this.arrow.GetHTML().style.left=100*e+"%";var i=this.arrow.GetHTML().getBoundingClientRect();i.left<0?this.arrow.GetHTML().style.left=i.width/2+"px":i.right>this.GetHTML().getBoundingClientRect().right&&(this.arrow.GetHTML().style.left=this.GetHTML().getBoundingClientRect().right-i.width/2+"px")},e.prototype.Sync=function(t){this.progresbar.GetHTML().style.width=this.length>0?t/this.length*100+"%":"O%"},e.prototype.SetBuffer=function(t){this.bufferbar.GetHTML().style.width=this.length>0?t/this.length*100+"%":"O%"},e.prototype.SkipTo=function(t){this.events.trigger(r.VideoEventType.JumpTo,t/this.length),this.Sync(t)},e}(o.Panel);Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=a}});
//# sourceMappingURL=player.js.map